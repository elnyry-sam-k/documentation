<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="9411px" preserveAspectRatio="none" style="width:1804px;height:9411px;" version="1.1" viewBox="0 0 1804 9411" width="1804px" zoomAndPan="magnify"><defs><filter height="300%" id="f1530cd3ghsz0m" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="738" x="534" y="23.5352">2.2.2. Fulfil Handler Consume (Reject/Abort) (single message, includes individual transfers from Bulk)</text><rect fill="#FFFFE0" height="9366.2852" style="stroke: #A80036; stroke-width: 1.0;" width="1640.5" x="29" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="798.75" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="60" y="196.2188"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="9198.998" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="353" y="126.2871"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="893" y="6834.0488"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="893" y="7299.7676"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="893" y="8807.5664"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="893" y="9273.2852"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="2147.4336"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="2766.9707"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="3458.8184"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="5854.9453"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="7828.4629"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1242" y="1651.0938"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1242" y="6320.6641"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1242" y="8294.1816"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="167.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="681.1875"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="167.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="974.9141"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="121.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="3569.3945"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="121.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="3774.2578"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="137.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="4046.3633"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="121.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="4332.1133"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="4764.998" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="4561.2871"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="4359.3613" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1356.5" y="4966.9238"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="93.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="725.8086"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="93.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="1019.5352"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="3598.7051"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="3803.5684"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="4075.6738"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="4361.4238"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="4590.5977"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="4996.2344"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="5237.9629" style="stroke: #000000; stroke-width: 2.0;" width="1780" x="13" y="133.2871"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="5206.6523" style="stroke: #000000; stroke-width: 2.0;" width="1760" x="23" y="157.5977"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="619" x="289" y="241.2188"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="599" x="299" y="265.5293"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="92.2422" style="stroke: #000000; stroke-width: 2.0;" width="753" x="299" y="361.4609"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="103.2422" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="467.7031"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="3121.3809" style="stroke: #000000; stroke-width: 2.0;" width="1514" x="259" y="584.9453"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="2778.3438" style="stroke: #000000; stroke-width: 2.0;" width="1476" x="269" y="920.9824"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="2353.7305" style="stroke: #000000; stroke-width: 2.0;" width="1048" x="279" y="1157.0879"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="1011.0352" style="stroke: #000000; stroke-width: 2.0;" width="1028" x="289" y="1181.3984"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="979.7246" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="1205.709"/><rect fill="#FFFFFF" height="496.3398" style="stroke: none; stroke-width: 1.0;" width="1008" x="299" y="1689.0938"/><rect fill="#FFFFFF" height="619.5371" style="stroke: none; stroke-width: 1.0;" width="1048" x="279" y="2199.4336"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="590.582" style="stroke: #000000; stroke-width: 2.0;" width="1028" x="289" y="2221.3887"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="559.2715" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="2245.6992"/><rect fill="#FFFFFF" height="481.0293" style="stroke: none; stroke-width: 1.0;" width="1008" x="299" y="2323.9414"/><rect fill="#FFFFFF" height="103.8867" style="stroke: none; stroke-width: 1.0;" width="1048" x="279" y="2818.9707"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="314" x="299" y="2840.9258"/><rect fill="#FFFFFF" height="587.9609" style="stroke: none; stroke-width: 1.0;" width="1048" x="279" y="2922.8574"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="571.9609" style="stroke: #000000; stroke-width: 2.0;" width="918" x="289" y="2931.8574"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="540.6504" style="stroke: #000000; stroke-width: 2.0;" width="898" x="299" y="2956.168"/><rect fill="#FFFFFF" height="481.0293" style="stroke: none; stroke-width: 1.0;" width="898" x="299" y="3015.7891"/><rect fill="#FFFFFF" height="181.5078" style="stroke: none; stroke-width: 1.0;" width="1476" x="269" y="3517.8184"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="1582.6582" style="stroke: #000000; stroke-width: 2.0;" width="1444" x="279" y="3720.3262"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="558.5449" style="stroke: #000000; stroke-width: 2.0;" width="1417" x="289" y="3910.5"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="199.1738" style="stroke: #000000; stroke-width: 2.0;" width="1397" x="299" y="3992.4316"/><rect fill="#FFFFFF" height="270.4395" style="stroke: none; stroke-width: 1.0;" width="1417" x="289" y="4198.6055"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="183.8633" style="stroke: #000000; stroke-width: 2.0;" width="1396" x="299" y="4278.1816"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="376.6816" style="stroke: #000000; stroke-width: 2.0;" width="1424" x="289" y="4483.0449"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="183.8633" style="stroke: #000000; stroke-width: 2.0;" width="1404" x="299" y="4507.3555"/><rect fill="#FFFFFF" height="103.8867" style="stroke: none; stroke-width: 1.0;" width="1424" x="289" y="4755.8398"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="314" x="299" y="4777.7949"/><rect fill="#FFFFFF" height="436.2578" style="stroke: none; stroke-width: 1.0;" width="1444" x="279" y="4866.7266"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="407.3027" style="stroke: #000000; stroke-width: 2.0;" width="1424" x="289" y="4888.6816"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="214.4844" style="stroke: #000000; stroke-width: 2.0;" width="1404" x="299" y="4912.9922"/><rect fill="#FFFFFF" height="103.8867" style="stroke: none; stroke-width: 1.0;" width="1424" x="289" y="5192.0977"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="498" x="299" y="5214.0527"/><rect fill="#FFFFFF" height="54.2656" style="stroke: none; stroke-width: 1.0;" width="1760" x="23" y="5309.9844"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="980.4141" style="stroke: #000000; stroke-width: 2.0;" width="1028" x="289" y="5385.25"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="949.1035" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="5409.5605"/><rect fill="#FFFFFF" height="465.7188" style="stroke: none; stroke-width: 1.0;" width="1008" x="299" y="5892.9453"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="965.1035" style="stroke: #000000; stroke-width: 2.0;" width="699" x="289" y="6379.6641"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="933.793" style="stroke: #000000; stroke-width: 2.0;" width="679" x="299" y="6403.9746"/><rect fill="#FFFFFF" height="465.7188" style="stroke: none; stroke-width: 1.0;" width="679" x="299" y="6872.0488"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="980.4141" style="stroke: #000000; stroke-width: 2.0;" width="1028" x="289" y="7358.7676"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="949.1035" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="7383.0781"/><rect fill="#FFFFFF" height="465.7188" style="stroke: none; stroke-width: 1.0;" width="1008" x="299" y="7866.4629"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="965.1035" style="stroke: #000000; stroke-width: 2.0;" width="699" x="289" y="8353.1816"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="933.793" style="stroke: #000000; stroke-width: 2.0;" width="679" x="299" y="8377.4922"/><rect fill="#FFFFFF" height="465.7188" style="stroke: none; stroke-width: 1.0;" width="679" x="299" y="8845.5664"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="65" x2="65" y1="116.2871" y2="9335.2852"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="358" x2="358" y1="116.2871" y2="9335.2852"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="898" x2="898" y1="116.2871" y2="9335.2852"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1010" x2="1010" y1="116.2871" y2="9335.2852"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1119" x2="1119" y1="116.2871" y2="9335.2852"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1247" x2="1247" y1="116.2871" y2="9335.2852"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1356" x2="1356" y1="116.2871" y2="9335.2852"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1617.5" x2="1617.5" y1="116.2871" y2="9335.2852"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="37" y="60.3105"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="33" y="64.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="40" y="84.8457">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="45.5" y="101.334">fulfil</text><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="37" y="9334.2852"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="33" y="9338.2852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="40" y="9358.8203">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="45.5" y="9375.3086">fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="309" y="113.334">Fulfil Handler</text><ellipse cx="358" cy="83.7988" fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="354,71.7988,360,66.7988,358,71.7988,360,76.7988,354,71.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="309" y="9347.8203">Fulfil Handler</text><ellipse cx="358" cy="9366.7734" fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="354,9354.7734,360,9349.7734,358,9354.7734,360,9359.7734,354,9354.7734" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="832" y="60.3105"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="828" y="64.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="873" y="84.8457">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="835" y="101.334">transfer-position</text><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="832" y="9334.2852"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="828" y="9338.2852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="873" y="9358.8203">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="835" y="9375.3086">transfer-position</text><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="982" y="60.3105"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="978" y="64.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="985" y="84.8457">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="987.5" y="101.334">event</text><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="982" y="9334.2852"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="978" y="9338.2852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="985" y="9358.8203">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="987.5" y="9375.3086">event</text><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1056" y="60.3105"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1052" y="64.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1094.5" y="84.8457">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1059" y="101.334">bulk-processing</text><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1056" y="9334.2852"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1052" y="9338.2852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1094.5" y="9358.8203">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1059" y="9375.3086">bulk-processing</text><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1201" y="60.3105"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1197" y="64.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1222" y="84.8457">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1204" y="101.334">notification</text><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1201" y="9334.2852"/><rect fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1197" y="9338.2852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1222" y="9358.8203">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1204" y="9375.3086">notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="1307" y="113.334">Transfer DAO</text><ellipse cx="1356.5" cy="83.7988" fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1344.5" x2="1368.5" y1="97.7988" y2="97.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="1307" y="9347.8203">Transfer DAO</text><ellipse cx="1356.5" cy="9366.7734" fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1344.5" x2="1368.5" y1="9380.7734" y2="9380.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1569.5" y="113.334">Central Store</text><path d="M1599.5,63.7988 C1599.5,53.7988 1617.5,53.7988 1617.5,53.7988 C1617.5,53.7988 1635.5,53.7988 1635.5,63.7988 L1635.5,89.7988 C1635.5,99.7988 1617.5,99.7988 1617.5,99.7988 C1617.5,99.7988 1599.5,99.7988 1599.5,89.7988 L1599.5,63.7988 " fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1599.5,63.7988 C1599.5,73.7988 1617.5,73.7988 1617.5,73.7988 C1617.5,73.7988 1635.5,73.7988 1635.5,63.7988 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1569.5" y="9347.8203">Central Store</text><path d="M1599.5,9360.7734 C1599.5,9350.7734 1617.5,9350.7734 1617.5,9350.7734 C1617.5,9350.7734 1635.5,9350.7734 1635.5,9360.7734 L1635.5,9386.7734 C1635.5,9396.7734 1617.5,9396.7734 1617.5,9396.7734 C1617.5,9396.7734 1599.5,9396.7734 1599.5,9386.7734 L1599.5,9360.7734 " fill="#FEFECE" filter="url(#f1530cd3ghsz0m)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1599.5,9360.7734 C1599.5,9370.7734 1617.5,9370.7734 1617.5,9370.7734 C1617.5,9370.7734 1635.5,9370.7734 1635.5,9360.7734 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="60" y="196.2188"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="9198.998" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="353" y="126.2871"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="893" y="6834.0488"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="893" y="7299.7676"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="893" y="8807.5664"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="893" y="9273.2852"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="2147.4336"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="2766.9707"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="3458.8184"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="5854.9453"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="7828.4629"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1242" y="1651.0938"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1242" y="6320.6641"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1242" y="8294.1816"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="167.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="681.1875"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="167.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="974.9141"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="121.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="3569.3945"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="121.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="3774.2578"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="137.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="4046.3633"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="121.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="4332.1133"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="4764.998" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1351.5" y="4561.2871"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="4359.3613" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1356.5" y="4966.9238"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="93.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="725.8086"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="93.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="1019.5352"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="3598.7051"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="3803.5684"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="4075.6738"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="4361.4238"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="4590.5977"/><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1612.5" y="4996.2344"/><path d="M13,133.2871 L276,133.2871 L276,140.2871 L266,150.2871 L13,150.2871 L13,133.2871 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="5237.9629" style="stroke: #000000; stroke-width: 2.0;" width="1780" x="13" y="133.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="218" x="28" y="146.8555">Fulfil Handler Consume (Failure)</text><path d="M23,157.5977 L85,157.5977 L85,164.5977 L75,174.5977 L23,174.5977 L23,157.5977 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="5206.6523" style="stroke: #000000; stroke-width: 2.0;" width="1760" x="23" y="157.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="38" y="171.166">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="149" x="100" y="170.2324">[Consume Single Message]</text><polygon fill="#A80036" points="81,192.2188,71,196.2188,81,200.2188,77,196.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="75" x2="352" y1="196.2188" y2="196.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="87" y="191.4766">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="100" y="191.4766">Consume Fulfil event message for Payer</text><path d="M289,241.2188 L373,241.2188 L373,248.2188 L363,258.2188 L289,258.2188 L289,241.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="619" x="289" y="241.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="304" y="254.7871">break</text><path d="M299,265.5293 L441,265.5293 L441,272.5293 L431,282.5293 L299,282.5293 L299,265.5293 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="599" x="299" y="265.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="314" y="279.0977">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="319.4609" y2="319.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="319.4609" y2="332.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="332.4609" y2="332.4609"/><polygon fill="#A80036" points="374,328.4609,364,332.4609,374,336.4609,370,332.4609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="370" y="307.0635">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="503" x="383" y="299.4082">Validate event - Rule: type IN ['fulfil','bulk-fulfil'] &amp;&amp; ( action IN ['reject','abort'] )</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="383" y="314.7188">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="467" y="314.7188">2001</text><path d="M299,361.4609 L514,361.4609 L514,368.4609 L504,378.4609 L299,378.4609 L299,361.4609 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="92.2422" style="stroke: #000000; stroke-width: 2.0;" width="753" x="299" y="361.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="314" y="375.0293">Persist Event Information</text><polygon fill="#A80036" points="998,396.082,1008,400.082,998,404.082,1002,400.082" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1004" y1="400.082" y2="400.082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="370" y="395.3398">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="383" y="395.3398">Publish event information</text><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="40.6211" style="stroke: #000000; stroke-width: 2.0;" width="735" x="306" y="408.082"/><polygon fill="#EEEEEE" points="306,408.082,370,408.082,370,415.082,360,425.082,306,425.082,306,408.082" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="319" y="422.6504">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="578.5" y="441.6504">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="32" x="736.5" y="441.6504">9.1.0</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="736.5" x2="768.5" y1="443.6504" y2="443.6504"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="768.5" y="441.6504">}</text><path d="M299,467.7031 L521,467.7031 L521,474.7031 L511,484.7031 L299,484.7031 L299,467.7031 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="103.2422" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="467.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="177" x="314" y="481.2715">Validate FSPIOP-Signature</text><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="990" x="306" y="510.0137"/><polygon fill="#EEEEEE" points="306,510.0137,370,510.0137,370,517.0137,360,527.0137,306,527.0137,306,510.0137" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="319" y="524.582">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="547.5" y="543.582">Validate message.content.headers.</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="765.5" y="543.582">FSPIOP-Signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="887.5" y="543.582">{</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-signature-validation.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-signature-validation.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="159" x="891.5" y="543.582">seq-signature-validation</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="891.5" x2="1050.5" y1="545.582" y2="545.582"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1050.5" y="543.582">}</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="547.5" y="558.8926">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="631.5" y="558.8926">2001</text><path d="M259,584.9453 L571,584.9453 L571,591.9453 L561,601.9453 L259,601.9453 L259,584.9453 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="3121.3809" style="stroke: #000000; stroke-width: 2.0;" width="1514" x="259" y="584.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="267" x="274" y="598.5137">Validate Transfer Fulfil Duplicate Check</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="623.5664" y2="623.5664"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="623.5664" y2="636.5664"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="636.5664" y2="636.5664"/><polygon fill="#A80036" points="374,632.5664,364,636.5664,374,640.5664,370,636.5664" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="370" y="618.8242">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="383" y="618.8242">Generate transferFulfilmentId uuid</text><polygon fill="#A80036" points="1339.5,677.1875,1349.5,681.1875,1339.5,685.1875,1343.5,681.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1345.5" y1="681.1875" y2="681.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="370" y="668.79">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="369" x="383" y="661.1348">Request to retrieve transfer fulfilment hashes by transferId</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="383" y="676.4453">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="460" y="676.4453">2003</text><polygon fill="#A80036" points="1600.5,721.8086,1610.5,725.8086,1600.5,729.8086,1604.5,725.8086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1361.5" x2="1606.5" y1="725.8086" y2="725.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1368.5" y="713.4111">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="1381.5" y="705.7559">Request Transfer fulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="1381.5" y="721.0664">duplicate message hashes</text><polygon fill="#FFFFE0" filter="url(#f1530cd3ghsz0m)" points="1482,738.8086,1753,738.8086,1763,764.8086,1753,791.8086,1482,791.8086,1472,764.8086,1482,738.8086" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="1484" y="755.377">SELET transferId, hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="1484" y="770.6875">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="227" x="1524" y="770.6875">transferFulfilmentDuplicateCheck</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="1484" y="785.998">WHERE transferId = request.params.id</text><polygon fill="#A80036" points="1372.5,815.0508,1362.5,819.0508,1372.5,823.0508,1368.5,819.0508" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1366.5" x2="1616.5" y1="819.0508" y2="819.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1378.5" y="814.3086">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="1391.5" y="814.3086">Return existing hashes</text><polygon fill="#A80036" points="374,844.3613,364,848.3613,374,852.3613,370,848.3613" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="368" x2="1355.5" y1="848.3613" y2="848.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="380" y="843.6191">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="299" x="393" y="843.6191">Return (list of) transfer fulfil messages hash(es)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="892.9824" y2="892.9824"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="892.9824" y2="905.9824"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="905.9824" y2="905.9824"/><polygon fill="#A80036" points="374,901.9824,364,905.9824,374,909.9824,370,905.9824" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="370" y="880.585">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="383" y="872.9297">Loop the list of returned hashes &amp; compare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="383" y="888.2402">each entry with the calculated message hash</text><path d="M269,920.9824 L331,920.9824 L331,927.9824 L321,937.9824 L269,937.9824 L269,920.9824 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="2778.3438" style="stroke: #000000; stroke-width: 2.0;" width="1476" x="269" y="920.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="284" y="934.5508">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87" x="346" y="933.6172">[Hash matched]</text><polygon fill="#A80036" points="1339.5,970.9141,1349.5,974.9141,1339.5,978.9141,1343.5,974.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1345.5" y1="974.9141" y2="974.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="962.5166">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="346" x="392" y="954.8613">Request to retrieve Transfer Fulfilment &amp; Transfer state</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="392" y="970.1719">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="469" y="970.1719">2003</text><polygon fill="#A80036" points="1600.5,1015.5352,1610.5,1019.5352,1600.5,1023.5352,1604.5,1019.5352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1361.5" x2="1606.5" y1="1019.5352" y2="1019.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1368.5" y="1007.1377">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1390.5" y="999.4824">Request to retrieve</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="1390.5" y="1014.793">transferFulfilment &amp; transferState</text><polygon fill="#FFFFE0" filter="url(#f1530cd3ghsz0m)" points="1552,1032.5352,1683,1032.5352,1693,1051.5352,1683,1070.5352,1552,1070.5352,1542,1051.5352,1552,1032.5352" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="1554" y="1049.1035">transferFulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="1554" y="1064.4141">transferStateChange</text><polygon fill="#A80036" points="1372.5,1108.7773,1362.5,1112.7773,1372.5,1116.7773,1368.5,1112.7773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1366.5" x2="1616.5" y1="1112.7773" y2="1112.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1378.5" y="1100.3799">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="1400.5" y="1092.7246">Return transferFulfilment &amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="1400.5" y="1108.0352">transferState</text><polygon fill="#A80036" points="374,1138.0879,364,1142.0879,374,1146.0879,370,1142.0879" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="368" x2="1355.5" y1="1142.0879" y2="1142.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="380" y="1137.3457">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="402" y="1137.3457">Return Transfer Fulfilment &amp; Transfer state</text><path d="M279,1157.0879 L341,1157.0879 L341,1164.0879 L331,1174.0879 L279,1174.0879 L279,1157.0879 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="2353.7305" style="stroke: #000000; stroke-width: 2.0;" width="1048" x="279" y="1157.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="294" y="1170.6563">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="185" x="356" y="1169.7227">[transferFulfilment.isValid == 0]</text><path d="M289,1181.3984 L373,1181.3984 L373,1188.3984 L363,1198.3984 L289,1198.3984 L289,1181.3984 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1011.0352" style="stroke: #000000; stroke-width: 2.0;" width="1028" x="289" y="1181.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="304" y="1194.9668">break</text><path d="M299,1205.709 L361,1205.709 L361,1212.709 L351,1222.709 L299,1222.709 L299,1205.709 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="979.7246" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="1205.709"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="314" y="1219.2773">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="376" y="1218.3438">[If type == 'fulfil']</text><path d="M368,1228.0195 L368,1605.0195 L677,1605.0195 L677,1238.0195 L667,1228.0195 L368,1228.0195 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,1228.0195 L667,1238.0195 L677,1238.0195 L667,1228.0195 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="1245.5879">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="1260.8984">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="1276.209">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="1291.5195">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="1306.8301">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="1322.1406">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="1337.4512">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="1352.7617">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="1368.0723">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="1383.3828">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="1398.6934">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="1414.0039">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="1429.3145">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="1444.625">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="422" y="1459.9355">type: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="422" y="1475.2461">action: fulfil-duplicate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="1490.5566">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="1505.8672">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="438" y="1521.1777">status: "fail",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="1536.4883">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="1551.7988">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="1567.1094">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="1582.4199">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="1597.7305">}</text><polygon fill="#A80036" points="1230,1647.0938,1240,1651.0938,1230,1655.0938,1234,1651.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1236" y1="1651.0938" y2="1651.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="1638.6963">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="349" x="392" y="1631.041">Publish Notification event for Payee - Modified Request</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="392" y="1646.3516">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="476" y="1646.3516">3106</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="299" x2="1307" y1="1690.0938" y2="1690.0938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="304" y="1700.7285">[If type == 'bulk-fulfil']</text><path d="M368,1709.0488 L368,2086.0488 L677,2086.0488 L677,1719.0488 L667,1709.0488 L368,1709.0488 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,1709.0488 L667,1719.0488 L677,1719.0488 L667,1709.0488 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="1726.6172">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="1741.9277">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="1757.2383">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="1772.5488">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="1787.8594">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="1803.1699">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="1818.4805">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="1833.791">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="1849.1016">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="1864.4121">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="1879.7227">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="1895.0332">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="1910.3438">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="1925.6543">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="422" y="1940.9648">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="422" y="1956.2754">action: fulfil-duplicate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="1971.5859">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="1986.8965">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="438" y="2002.207">status: "fail",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="2017.5176">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="2032.8281">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="2048.1387">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="2063.4492">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="2078.7598">}</text><polygon fill="#A80036" points="1102.5,2143.4336,1112.5,2147.4336,1102.5,2151.4336,1106.5,2147.4336" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1108.5" y1="2147.4336" y2="2147.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="2127.3809">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="349" x="392" y="2112.0703">Publish Notification event for Payee - Modified Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="392" y="2127.3809">3106 to Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="392" y="2142.6914">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="476" y="2142.6914">3106</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="279" x2="1327" y1="2200.4336" y2="2200.4336"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="254" x="284" y="2211.0684">[transferState IN ['COMMITTED', 'ABORTED']]</text><path d="M289,2221.3887 L373,2221.3887 L373,2228.3887 L363,2238.3887 L289,2238.3887 L289,2221.3887 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="590.582" style="stroke: #000000; stroke-width: 2.0;" width="1028" x="289" y="2221.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="304" y="2234.957">break</text><path d="M299,2245.6992 L361,2245.6992 L361,2252.6992 L351,2262.6992 L299,2262.6992 L299,2245.6992 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="559.2715" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="2245.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="314" y="2259.2676">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="376" y="2258.334">[If type == 'fulfil']</text><rect fill="#FFFFFF" filter="url(#f1530cd3ghsz0m)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="990" x="306" y="2263.0098"/><polygon fill="#EEEEEE" points="306,2263.0098,370,2263.0098,370,2270.0098,360,2280.0098,306,2280.0098,306,2263.0098" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="319" y="2277.5781">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="652.5" y="2296.5781">Send notification to Participant (Payee) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="43" x="902.5" y="2296.5781">1.1.4.a</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="902.5" x2="945.5" y1="2298.5781" y2="2298.5781"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="945.5" y="2296.5781">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="656.5" y="2311.8887"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="299" x2="1307" y1="2324.9414" y2="2324.9414"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="304" y="2335.5762">[If type == 'bulk-fulfil']</text><path d="M368,2343.8965 L368,2720.8965 L677,2720.8965 L677,2353.8965 L667,2343.8965 L368,2343.8965 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,2343.8965 L667,2353.8965 L677,2353.8965 L667,2343.8965 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="2361.4648">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="2376.7754">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="2392.0859">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="2407.3965">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="2422.707">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="2438.0176">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="2453.3281">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="2468.6387">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="2483.9492">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="2499.2598">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="2514.5703">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="2529.8809">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="2545.1914">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="2560.502">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="422" y="2575.8125">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="422" y="2591.123">action: fulfil-duplicate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="2606.4336">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="2621.7441">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="438" y="2637.0547">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="2652.3652">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="2667.6758">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="2682.9863">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="2698.2969">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="2713.6074">}</text><polygon fill="#A80036" points="1102.5,2762.9707,1112.5,2766.9707,1102.5,2770.9707,1106.5,2766.9707" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1108.5" y1="2766.9707" y2="2766.9707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="2754.5732">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="383" x="392" y="2746.918">Publish Notification event for Payee to Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="392" y="2762.2285">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="476" y="2762.2285">2003</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="279" x2="1327" y1="2819.9707" y2="2819.9707"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="177" x="284" y="2830.6055">[transferState NOT 'RESERVED']</text><path d="M299,2840.9258 L383,2840.9258 L383,2847.9258 L373,2857.9258 L299,2857.9258 L299,2840.9258 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="314" x="299" y="2840.9258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="314" y="2854.4941">break</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="2894.8574" y2="2894.8574"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="2894.8574" y2="2907.8574"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="2907.8574" y2="2907.8574"/><polygon fill="#A80036" points="374,2903.8574,364,2907.8574,374,2911.8574,370,2907.8574" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="2882.46">17</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="209" x="392" y="2874.8047">Reference: Failure in validation</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="392" y="2890.1152">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="469" y="2890.1152">2001</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="279" x2="1327" y1="2923.8574" y2="2923.8574"/><path d="M289,2931.8574 L373,2931.8574 L373,2938.8574 L363,2948.8574 L289,2948.8574 L289,2931.8574 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="571.9609" style="stroke: #000000; stroke-width: 2.0;" width="918" x="289" y="2931.8574"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="304" y="2945.4258">break</text><path d="M299,2956.168 L361,2956.168 L361,2963.168 L351,2973.168 L299,2973.168 L299,2956.168 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="540.6504" style="stroke: #000000; stroke-width: 2.0;" width="898" x="299" y="2956.168"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="314" y="2969.7363">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="376" y="2968.8027">[If type == 'fulfil']</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="2994.7891" y2="2994.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="2994.7891" y2="3007.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="3007.7891" y2="3007.7891"/><polygon fill="#A80036" points="374,3003.7891,364,3007.7891,374,3011.7891,370,3007.7891" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="2990.0469">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="392" y="2990.0469">Allow previous request to complete</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="299" x2="1197" y1="3016.7891" y2="3016.7891"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="304" y="3027.4238">[If type == 'bulk-fulfil']</text><path d="M368,3035.7441 L368,3412.7441 L677,3412.7441 L677,3045.7441 L667,3035.7441 L368,3035.7441 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,3035.7441 L667,3045.7441 L677,3045.7441 L667,3035.7441 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="3053.3125">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="3068.623">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="3083.9336">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="3099.2441">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="3114.5547">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="3129.8652">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="3145.1758">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="3160.4863">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="3175.7969">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="3191.1074">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="3206.418">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="3221.7285">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="3237.0391">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="3252.3496">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="422" y="3267.6602">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="422" y="3282.9707">action: fulfil-duplicate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="3298.2813">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="3313.5918">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="438" y="3328.9023">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="3344.2129">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="3359.5234">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="3374.834">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="3390.1445">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="3405.4551">}</text><polygon fill="#A80036" points="1102.5,3454.8184,1112.5,3458.8184,1102.5,3462.8184,1106.5,3458.8184" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1108.5" y1="3458.8184" y2="3458.8184"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="3446.4209">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="383" x="392" y="3438.7656">Publish Notification event for Payee to Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="392" y="3454.0762">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="476" y="3454.0762">2003</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="269" x2="1745" y1="3518.8184" y2="3518.8184"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="109" x="274" y="3529.4531">[Hash not matched]</text><polygon fill="#A80036" points="1339.5,3565.3945,1349.5,3569.3945,1339.5,3573.3945,1343.5,3569.3945" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1345.5" y1="3569.3945" y2="3569.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="3556.9971">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="392" y="3549.3418">Request to persist transfer hash</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="392" y="3564.6523">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="476" y="3564.6523">2003</text><polygon fill="#A80036" points="1600.5,3594.7051,1610.5,3598.7051,1600.5,3602.7051,1604.5,3598.7051" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1361.5" x2="1606.5" y1="3598.7051" y2="3598.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1368.5" y="3593.9629">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="1390.5" y="3593.9629">Persist hash</text><polygon fill="#FFFFE0" filter="url(#f1530cd3ghsz0m)" points="1509,3641.7051,1725,3641.7051,1735,3652.7051,1725,3664.7051,1509,3664.7051,1499,3652.7051,1509,3641.7051" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="1511" y="3658.2734">transferFulfilmentDuplicateCheck</text><polygon fill="#A80036" points="374,3687.3262,364,3691.3262,374,3695.3262,370,3691.3262" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="368" x2="1355.5" y1="3691.3262" y2="3691.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="380" y="3686.584">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="402" y="3686.584">Return success</text><path d="M279,3720.3262 L341,3720.3262 L341,3727.3262 L331,3737.3262 L279,3737.3262 L279,3720.3262 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1582.6582" style="stroke: #000000; stroke-width: 2.0;" width="1444" x="279" y="3720.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="294" y="3733.8945">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="287" x="356" y="3732.9609">[action=='reject' call made on PUT /transfers/{ID}]</text><polygon fill="#A80036" points="1339.5,3770.2578,1349.5,3774.2578,1339.5,3778.2578,1343.5,3774.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1345.5" y1="3774.2578" y2="3774.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="3761.8604">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="275" x="392" y="3754.2051">Request information for the validate checks</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="392" y="3769.5156">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="469" y="3769.5156">2003</text><polygon fill="#A80036" points="1600.5,3799.5684,1610.5,3803.5684,1600.5,3807.5684,1604.5,3803.5684" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1361.5" x2="1606.5" y1="3803.5684" y2="3803.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1368.5" y="3798.8262">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="1390.5" y="3798.8262">Fetch from database</text><polygon fill="#FFFFE0" filter="url(#f1530cd3ghsz0m)" points="1591,3816.5684,1644,3816.5684,1654,3827.5684,1644,3839.5684,1591,3839.5684,1581,3827.5684,1591,3816.5684" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="1593" y="3833.1367">transfer</text><polygon fill="#A80036" points="1372.5,3862.1895,1362.5,3866.1895,1372.5,3870.1895,1368.5,3866.1895" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1366.5" x2="1616.5" y1="3866.1895" y2="3866.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1378.5" y="3861.4473">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1404.5" y="3861.4473"/><polygon fill="#A80036" points="374,3891.5,364,3895.5,374,3899.5,370,3895.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="368" x2="1355.5" y1="3895.5" y2="3895.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="380" y="3890.7578">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="402" y="3890.7578">Return transfer</text><path d="M289,3910.5 L351,3910.5 L351,3917.5 L341,3927.5 L289,3927.5 L289,3910.5 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="558.5449" style="stroke: #000000; stroke-width: 2.0;" width="1417" x="289" y="3910.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="304" y="3924.0684">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="313" x="366" y="3923.1348">[Fulfilment present in the PUT /transfers/{ID} message]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="3964.4316" y2="3964.4316"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="3964.4316" y2="3977.4316"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="3977.4316" y2="3977.4316"/><polygon fill="#A80036" points="374,3973.4316,364,3977.4316,374,3981.4316,370,3977.4316" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="3952.0342">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="472" x="392" y="3944.3789">Validate that Transfer.ilpCondition = SHA-256 (content.payload.fulfilment)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="392" y="3959.6895">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="469" y="3959.6895">2001</text><path d="M299,3992.4316 L459,3992.4316 L459,3999.4316 L449,4009.4316 L299,4009.4316 L299,3992.4316 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="199.1738" style="stroke: #000000; stroke-width: 2.0;" width="1397" x="299" y="3992.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="314" y="4006">Persist fulfilment</text><polygon fill="#A80036" points="1339.5,4042.3633,1349.5,4046.3633,1339.5,4050.3633,1343.5,4046.3633" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1345.5" y1="4046.3633" y2="4046.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="4033.9658">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="497" x="392" y="4026.3105">Persist fulfilment with the result of the above check (transferFulfilment.isValid)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="392" y="4041.6211">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="469" y="4041.6211">2003</text><polygon fill="#A80036" points="1600.5,4071.6738,1610.5,4075.6738,1600.5,4079.6738,1604.5,4075.6738" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1361.5" x2="1606.5" y1="4075.6738" y2="4075.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1368.5" y="4070.9316">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="1390.5" y="4070.9316">Persist to database</text><polygon fill="#FFFFE0" filter="url(#f1530cd3ghsz0m)" points="1559,4118.6738,1676,4118.6738,1686,4137.6738,1676,4156.6738,1559,4156.6738,1549,4137.6738,1559,4118.6738" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="1561" y="4135.2422">transferFulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1561" y="4150.5527">transferExtension</text><polygon fill="#A80036" points="374,4179.6055,364,4183.6055,374,4187.6055,370,4183.6055" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="368" x2="1355.5" y1="4183.6055" y2="4183.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="380" y="4178.8633">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="402" y="4178.8633">Return success</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="289" x2="1706" y1="4199.6055" y2="4199.6055"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="342" x="294" y="4210.2402">[Fulfilment NOT present in the PUT /transfers/{ID} message]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="4250.1816" y2="4250.1816"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="4250.1816" y2="4263.1816"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="4263.1816" y2="4263.1816"/><polygon fill="#A80036" points="374,4259.1816,364,4263.1816,374,4267.1816,370,4263.1816" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="4237.7842">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="362" x="392" y="4230.1289">Validate that transfer fulfilment message to Abort is valid</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="392" y="4245.4395">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="469" y="4245.4395">2001</text><path d="M299,4278.1816 L466,4278.1816 L466,4285.1816 L456,4295.1816 L299,4295.1816 L299,4278.1816 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="183.8633" style="stroke: #000000; stroke-width: 2.0;" width="1396" x="299" y="4278.1816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122" x="314" y="4291.75">Persist extensions</text><polygon fill="#A80036" points="1339.5,4328.1133,1349.5,4332.1133,1339.5,4336.1133,1343.5,4332.1133" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1345.5" y1="4332.1133" y2="4332.1133"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="4319.7158">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="392" y="4312.0605">Persist extensionList elements</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="392" y="4327.3711">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="469" y="4327.3711">2003</text><polygon fill="#A80036" points="1600.5,4357.4238,1610.5,4361.4238,1600.5,4365.4238,1604.5,4361.4238" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1361.5" x2="1606.5" y1="4361.4238" y2="4361.4238"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1368.5" y="4356.6816">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="1390.5" y="4356.6816">Persist to database</text><polygon fill="#FFFFE0" filter="url(#f1530cd3ghsz0m)" points="1560,4404.4238,1675,4404.4238,1685,4415.4238,1675,4427.4238,1560,4427.4238,1550,4415.4238,1560,4404.4238" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1562" y="4420.9922">transferExtension</text><polygon fill="#A80036" points="374,4450.0449,364,4454.0449,374,4458.0449,370,4454.0449" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="368" x2="1355.5" y1="4454.0449" y2="4454.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="380" y="4449.3027">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="402" y="4449.3027">Return success</text><path d="M289,4483.0449 L351,4483.0449 L351,4490.0449 L341,4500.0449 L289,4500.0449 L289,4483.0449 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="376.6816" style="stroke: #000000; stroke-width: 2.0;" width="1424" x="289" y="4483.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="304" y="4496.6133">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="429" x="366" y="4495.6797">[Transfer.ilpCondition validate successful OR generic validation successful]</text><path d="M299,4507.3555 L758,4507.3555 L758,4514.3555 L748,4524.3555 L299,4524.3555 L299,4507.3555 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="183.8633" style="stroke: #000000; stroke-width: 2.0;" width="1404" x="299" y="4507.3555"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="414" x="314" y="4520.9238">Persist Transfer State (with transferState='RECEIVED_REJECT')</text><polygon fill="#A80036" points="1339.5,4557.2871,1349.5,4561.2871,1339.5,4565.2871,1343.5,4561.2871" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1345.5" y1="4561.2871" y2="4561.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="4548.8896">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="392" y="4541.2344">Request to persist transfer state</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="392" y="4556.5449">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="469" y="4556.5449">2003</text><polygon fill="#A80036" points="1600.5,4586.5977,1610.5,4590.5977,1600.5,4594.5977,1604.5,4590.5977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1361.5" x2="1606.5" y1="4590.5977" y2="4590.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1368.5" y="4585.8555">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="1390.5" y="4585.8555">Persist transfer state</text><polygon fill="#FFFFE0" filter="url(#f1530cd3ghsz0m)" points="1552,4633.5977,1683,4633.5977,1693,4644.5977,1683,4656.5977,1552,4656.5977,1542,4644.5977,1552,4633.5977" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="1554" y="4650.166">transferStateChange</text><polygon fill="#A80036" points="374,4679.2188,364,4683.2188,374,4687.2188,370,4683.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="368" x2="1350.5" y1="4683.2188" y2="4683.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="380" y="4678.4766">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="402" y="4678.4766">Return success</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="4734.8398" y2="4734.8398"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="4734.8398" y2="4747.8398"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="4747.8398" y2="4747.8398"/><polygon fill="#A80036" points="374,4743.8398,364,4747.8398,374,4751.8398,370,4747.8398" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="4722.4424">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="392" y="4714.7871">Route &amp; Publish Position event for Payer</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="334" x="392" y="4730.0977">Reference: Publish Position Reject event for Payer</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="289" x2="1713" y1="4756.8398" y2="4756.8398"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="382" x="294" y="4767.4746">[Validate Fulfil Transfer not successful or Generic validation failed]</text><path d="M299,4777.7949 L383,4777.7949 L383,4784.7949 L373,4794.7949 L299,4794.7949 L299,4777.7949 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="314" x="299" y="4777.7949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="314" y="4791.3633">break</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="4831.7266" y2="4831.7266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="4831.7266" y2="4844.7266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="4844.7266" y2="4844.7266"/><polygon fill="#A80036" points="374,4840.7266,364,4844.7266,374,4848.7266,370,4844.7266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="4819.3291">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="392" y="4811.6738">Publish event for Payee</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="209" x="392" y="4826.9844">Reference: Failure in validation</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="279" x2="1723" y1="4867.7266" y2="4867.7266"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="284" y="4878.3613">[action=='abort' Error callback]</text><path d="M289,4888.6816 L351,4888.6816 L351,4895.6816 L341,4905.6816 L289,4905.6816 L289,4888.6816 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="407.3027" style="stroke: #000000; stroke-width: 2.0;" width="1424" x="289" y="4888.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="304" y="4902.25">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="366" y="4901.3164">[Validation successful]</text><path d="M299,4912.9922 L756,4912.9922 L756,4919.9922 L746,4929.9922 L299,4929.9922 L299,4912.9922 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="214.4844" style="stroke: #000000; stroke-width: 2.0;" width="1404" x="299" y="4912.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="412" x="314" y="4926.5605">Persist Transfer State (with transferState='RECEIVED_ERROR')</text><polygon fill="#A80036" points="1344.5,4962.9238,1354.5,4966.9238,1344.5,4970.9238,1348.5,4966.9238" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1350.5" y1="4966.9238" y2="4966.9238"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="4954.5264">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="392" y="4946.8711">Request to persist transfer state &amp; Error</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="392" y="4962.1816">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="469" y="4962.1816">2003</text><polygon fill="#A80036" points="1600.5,4992.2344,1610.5,4996.2344,1600.5,5000.2344,1604.5,4996.2344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1366.5" x2="1606.5" y1="4996.2344" y2="4996.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1373.5" y="4991.4922">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="1395.5" y="4991.4922">Persist transfer state &amp; Error</text><polygon fill="#FFFFE0" filter="url(#f1530cd3ghsz0m)" points="1552,5039.2344,1683,5039.2344,1693,5065.2344,1683,5092.2344,1552,5092.2344,1542,5065.2344,1552,5039.2344" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="1554" y="5055.8027">transferStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="1554" y="5071.1133">transferError</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1554" y="5086.4238">transferExtension</text><polygon fill="#A80036" points="374,5115.4766,364,5119.4766,374,5123.4766,370,5119.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="368" x2="1355.5" y1="5119.4766" y2="5119.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="380" y="5114.7344">42</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="402" y="5114.7344">Return success</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="5171.0977" y2="5171.0977"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="5171.0977" y2="5184.0977"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="5184.0977" y2="5184.0977"/><polygon fill="#A80036" points="374,5180.0977,364,5184.0977,374,5188.0977,370,5184.0977" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="5158.7002">43</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="392" y="5151.0449">Error callback validated</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="381" x="392" y="5166.3555">Reference: Produce message for validated error callback</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="289" x2="1713" y1="5193.0977" y2="5193.0977"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="274" x="294" y="5203.7324">[Validate Transfer Error Message not successful]</text><path d="M299,5214.0527 L383,5214.0527 L383,5221.0527 L373,5231.0527 L299,5231.0527 L299,5214.0527 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="498" x="299" y="5214.0527"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="314" y="5227.6211">break</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="405" y1="5267.9844" y2="5267.9844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="5267.9844" y2="5280.9844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364" x2="405" y1="5280.9844" y2="5280.9844"/><polygon fill="#A80036" points="374,5276.9844,364,5280.9844,374,5284.9844,370,5280.9844" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="5255.5869">44</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="392" y="5247.9316">Notifications for failures</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="393" x="392" y="5263.2422">Reference: Validate Transfer Error Message not successful</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1783" y1="5310.9844" y2="5310.9844"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="28" y="5321.6191">[Consume Batch Messages]</text><path d="M130,5329.9395 L130,5354.9395 L344,5354.9395 L344,5339.9395 L334,5329.9395 L130,5329.9395 " fill="#ADD8E6" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M334,5329.9395 L334,5339.9395 L344,5339.9395 L334,5329.9395 " fill="#ADD8E6" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="136" y="5347.5078">To be delivered by future story</text><path d="M289,5385.25 L727,5385.25 L727,5392.25 L717,5402.25 L289,5402.25 L289,5385.25 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="980.4141" style="stroke: #000000; stroke-width: 2.0;" width="1028" x="289" y="5385.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="393" x="304" y="5398.8184">Reference: Validate Transfer Error Message not successful</text><path d="M299,5409.5605 L361,5409.5605 L361,5416.5605 L351,5426.5605 L299,5426.5605 L299,5409.5605 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="949.1035" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="5409.5605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="314" y="5423.1289">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="376" y="5422.1953">[If type == 'bulk-fulfil']</text><path d="M368,5431.8711 L368,5808.8711 L677,5808.8711 L677,5441.8711 L667,5431.8711 L368,5431.8711 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,5431.8711 L667,5441.8711 L677,5441.8711 L667,5431.8711 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="5449.4395">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="5464.75">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="5480.0605">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="5495.3711">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="5510.6816">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="5525.9922">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="5541.3027">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="5556.6133">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="5571.9238">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="5587.2344">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="5602.5449">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="5617.8555">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="5633.166">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="5648.4766">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="422" y="5663.7871">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="422" y="5679.0977">action: abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="5694.4082">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="5709.7188">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="438" y="5725.0293">status: "fail",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="5740.3398">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="5755.6504">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="5770.9609">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="5786.2715">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="5801.582">}</text><polygon fill="#A80036" points="1102.5,5850.9453,1112.5,5854.9453,1102.5,5858.9453,1106.5,5854.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1108.5" y1="5854.9453" y2="5854.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="5842.5479">45</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="376" x="392" y="5834.8926">Publish Processing event for Payee to Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="392" y="5850.2031">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="476" y="5850.2031">2003</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="299" x2="1307" y1="5893.9453" y2="5893.9453"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="304" y="5904.5801">[If type == 'fulfil']</text><path d="M368,5912.9004 L368,6289.9004 L677,6289.9004 L677,5922.9004 L667,5912.9004 L368,5912.9004 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,5912.9004 L667,5922.9004 L677,5922.9004 L667,5912.9004 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="5930.4688">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="5945.7793">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="5961.0898">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="5976.4004">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="5991.7109">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="6007.0215">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="6022.332">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="6037.6426">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="6052.9531">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="6068.2637">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="6083.5742">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="6098.8848">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="6114.1953">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="6129.5059">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="422" y="6144.8164">type: fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="422" y="6160.127">action: abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="6175.4375">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="6190.748">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="438" y="6206.0586">status: "fail",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="6221.3691">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="6236.6797">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="6251.9902">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="6267.3008">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="6282.6113">}</text><polygon fill="#A80036" points="1230,6316.6641,1240,6320.6641,1230,6324.6641,1234,6320.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1236" y1="6320.6641" y2="6320.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="6315.9219">46</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="392" y="6315.9219">Route &amp; Publish Notification event for Payee</text><path d="M289,6379.6641 L715,6379.6641 L715,6386.6641 L705,6396.6641 L289,6396.6641 L289,6379.6641 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="965.1035" style="stroke: #000000; stroke-width: 2.0;" width="699" x="289" y="6379.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="381" x="304" y="6393.2324">Reference: Produce message for validated error callback</text><path d="M299,6403.9746 L361,6403.9746 L361,6410.9746 L351,6420.9746 L299,6420.9746 L299,6403.9746 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="933.793" style="stroke: #000000; stroke-width: 2.0;" width="679" x="299" y="6403.9746"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="314" y="6417.543">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="376" y="6416.6094">[If type == 'bulk-fulfil']</text><path d="M368,6426.2852 L368,6803.2852 L677,6803.2852 L677,6436.2852 L667,6426.2852 L368,6426.2852 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,6426.2852 L667,6436.2852 L677,6436.2852 L667,6426.2852 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="6443.8535">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="6459.1641">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="6474.4746">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="6489.7852">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="6505.0957">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="6520.4063">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="6535.7168">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="6551.0273">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="6566.3379">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="6581.6484">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="6596.959">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="6612.2695">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="6627.5801">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="6642.8906">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="422" y="6658.2012">type: bulk-position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="422" y="6673.5117">action: abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="6688.8223">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="6704.1328">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="438" y="6719.4434">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="6734.7539">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="6750.0645">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="6765.375">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="6780.6855">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="6795.9961">}</text><polygon fill="#A80036" points="881,6830.0488,891,6834.0488,881,6838.0488,885,6834.0488" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="887" y1="6834.0488" y2="6834.0488"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="6829.3066">47</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="392" y="6829.3066">Route &amp; Publish Position event for Payer</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="299" x2="978" y1="6873.0488" y2="6873.0488"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="304" y="6883.6836">[If type == 'fulfil']</text><path d="M368,6892.0039 L368,7269.0039 L677,7269.0039 L677,6902.0039 L667,6892.0039 L368,6892.0039 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,6892.0039 L667,6902.0039 L677,6902.0039 L667,6892.0039 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="6909.5723">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="6924.8828">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="6940.1934">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="6955.5039">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="6970.8145">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="6986.125">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="7001.4355">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="7016.7461">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="7032.0566">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="7047.3672">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="7062.6777">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="7077.9883">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="7093.2988">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="7108.6094">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="422" y="7123.9199">type: position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="422" y="7139.2305">action: abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="7154.541">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="7169.8516">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="438" y="7185.1621">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="7200.4727">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="7215.7832">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="7231.0938">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="7246.4043">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="7261.7148">}</text><polygon fill="#A80036" points="881,7295.7676,891,7299.7676,881,7303.7676,885,7299.7676" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="887" y1="7299.7676" y2="7299.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="7295.0254">48</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="392" y="7295.0254">Route &amp; Publish Position event for Payer</text><path d="M289,7358.7676 L543,7358.7676 L543,7365.7676 L533,7375.7676 L289,7375.7676 L289,7358.7676 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="980.4141" style="stroke: #000000; stroke-width: 2.0;" width="1028" x="289" y="7358.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="209" x="304" y="7372.3359">Reference: Failure in validation</text><path d="M299,7383.0781 L361,7383.0781 L361,7390.0781 L351,7400.0781 L299,7400.0781 L299,7383.0781 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="949.1035" style="stroke: #000000; stroke-width: 2.0;" width="1008" x="299" y="7383.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="314" y="7396.6465">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="376" y="7395.7129">[If type == 'bulk-fulfil']</text><path d="M368,7405.3887 L368,7782.3887 L677,7782.3887 L677,7415.3887 L667,7405.3887 L368,7405.3887 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,7405.3887 L667,7415.3887 L677,7415.3887 L667,7405.3887 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="7422.957">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="7438.2676">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="7453.5781">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="7468.8887">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="7484.1992">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="7499.5098">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="7514.8203">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="7530.1309">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="7545.4414">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="7560.752">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="7576.0625">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="7591.373">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="7606.6836">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="7621.9941">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="422" y="7637.3047">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="422" y="7652.6152">action: reject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="7667.9258">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="7683.2363">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="438" y="7698.5469">status: "fail",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="7713.8574">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="7729.168">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="7744.4785">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="7759.7891">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="7775.0996">}</text><polygon fill="#A80036" points="1102.5,7824.4629,1112.5,7828.4629,1102.5,7832.4629,1106.5,7828.4629" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1108.5" y1="7828.4629" y2="7828.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="7816.0654">49</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="340" x="392" y="7808.4102">Publish processing event to the Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="392" y="7823.7207">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="476" y="7823.7207">2003</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="299" x2="1307" y1="7867.4629" y2="7867.4629"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="304" y="7878.0977">[If type == 'fulfil']</text><path d="M368,7886.418 L368,8263.418 L677,8263.418 L677,7896.418 L667,7886.418 L368,7886.418 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,7886.418 L667,7896.418 L677,7896.418 L667,7886.418 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="7903.9863">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="7919.2969">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="7934.6074">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="7949.918">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="7965.2285">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="7980.5391">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="7995.8496">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="8011.1602">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="8026.4707">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="8041.7813">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="8057.0918">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="8072.4023">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="8087.7129">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="8103.0234">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="422" y="8118.334">type: fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="422" y="8133.6445">action: reject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="8148.9551">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="8164.2656">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="438" y="8179.5762">status: "fail",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="8194.8867">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="8210.1973">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="8225.5078">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="8240.8184">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="8256.1289">}</text><polygon fill="#A80036" points="1230,8290.1816,1240,8294.1816,1230,8298.1816,1234,8294.1816" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="1236" y1="8294.1816" y2="8294.1816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="8289.4395">50</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="392" y="8289.4395">Route &amp; Publish Notification event for Payee</text><path d="M289,8353.1816 L668,8353.1816 L668,8360.1816 L658,8370.1816 L289,8370.1816 L289,8353.1816 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="965.1035" style="stroke: #000000; stroke-width: 2.0;" width="699" x="289" y="8353.1816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="334" x="304" y="8366.75">Reference: Publish Position Reject event for Payer</text><path d="M299,8377.4922 L361,8377.4922 L361,8384.4922 L351,8394.4922 L299,8394.4922 L299,8377.4922 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="933.793" style="stroke: #000000; stroke-width: 2.0;" width="679" x="299" y="8377.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="314" y="8391.0605">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="376" y="8390.127">[If type == 'bulk-fulfil']</text><path d="M368,8399.8027 L368,8776.8027 L677,8776.8027 L677,8409.8027 L667,8399.8027 L368,8399.8027 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,8399.8027 L667,8409.8027 L677,8409.8027 L667,8399.8027 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="8417.3711">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="8432.6816">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="8447.9922">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="8463.3027">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="8478.6133">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="8493.9238">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="8509.2344">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="8524.5449">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="8539.8555">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="8555.166">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="8570.4766">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="8585.7871">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="8601.0977">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="8616.4082">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="422" y="8631.7188">type: bulk-position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="422" y="8647.0293">action: reject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="8662.3398">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="8677.6504">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="438" y="8692.9609">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="8708.2715">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="8723.582">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="8738.8926">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="8754.2031">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="8769.5137">}</text><polygon fill="#A80036" points="881,8803.5664,891,8807.5664,881,8811.5664,885,8807.5664" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="887" y1="8807.5664" y2="8807.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="8802.8242">51</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="392" y="8802.8242">Route &amp; Publish Position event for Payer</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="299" x2="978" y1="8846.5664" y2="8846.5664"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="304" y="8857.2012">[If type == 'fulfil']</text><path d="M368,8865.5215 L368,9242.5215 L677,9242.5215 L677,8875.5215 L667,8865.5215 L368,8865.5215 " fill="#FFFF00" filter="url(#f1530cd3ghsz0m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,8865.5215 L667,8875.5215 L677,8875.5215 L667,8865.5215 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="374" y="8883.0898">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="8898.4004">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="390" y="8913.7109">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="390" y="8929.0215">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="8944.332">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="390" y="8959.6426">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="390" y="8974.9531">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="406" y="8990.2637">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="406" y="9005.5742">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="390" y="9020.8848">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="390" y="9036.1953">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="406" y="9051.5059">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="422" y="9066.8164">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="422" y="9082.127">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="422" y="9097.4375">type: position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="422" y="9112.748">action: reject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="422" y="9128.0586">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="422" y="9143.3691">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="438" y="9158.6797">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="438" y="9173.9902">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="422" y="9189.3008">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="406" y="9204.6113">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="390" y="9219.9219">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="374" y="9235.2324">}</text><polygon fill="#A80036" points="881,9269.2852,891,9273.2852,881,9277.2852,885,9273.2852" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363" x2="887" y1="9273.2852" y2="9273.2852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="370" y="9268.543">52</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="392" y="9268.543">Route &amp; Publish Position event for Payer</text><!--
@startuml
title 2.2.2. Fulfil Handler Consume (Reject/Abort) (single message, includes individual transfers from Bulk)

autonumber

collections "topic-\nfulfil" as TOPIC_FULFIL
control "Fulfil Handler" as FULF_HANDLER
collections "topic-\nevent" as TOPIC_EVENT
collections "topic-\ntransfer-position" as TOPIC_TRANSFER_POSITION
collections "topic-\nnotification" as TOPIC_NOTIFICATIONS
collections "topic-\nbulk-processing" as TOPIC_BULK_PROCESSING
entity "Transfer DAO" as TRANS_DAO
database "Central Store" as DB
box "Central Service" #LightYellow
    participant TOPIC_FULFIL
    participant FULF_HANDLER
    participant TOPIC_TRANSFER_POSITION
    participant TOPIC_EVENT
    participant TOPIC_BULK_PROCESSING
    participant TOPIC_NOTIFICATIONS
    participant TRANS_DAO
    participant DB
end box
activate FULF_HANDLER
group Fulfil Handler Consume (Failure)
    alt Consume Single Message
        TOPIC_FULFIL <- FULF_HANDLER: Consume Fulfil event message for Payer
        activate TOPIC_FULFIL
        deactivate TOPIC_FULFIL
        break
            group Validate Event
                FULF_HANDLER <-> FULF_HANDLER: Validate event - Rule: type IN ['fulfil','bulk-fulfil'] && ( action IN ['reject','abort'] )\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            FULF_HANDLER -> TOPIC_EVENT: Publish event information
            ref over FULF_HANDLER, TOPIC_EVENT:  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg 9.1.0]]}
        end
        group Validate FSPIOP-Signature
            |||
            ref over FULF_HANDLER, TOPIC_NOTIFICATIONS: Validate message.content.headers.**FSPIOP-Signature** {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-signature-validation.svg seq-signature-validation]]} \n<color #FF0000><b>Error codes:</b> 2001</color>
        end
        group Validate Transfer Fulfil Duplicate Check
            FULF_HANDLER -> FULF_HANDLER: Generate transferFulfilmentId uuid
            FULF_HANDLER -> TRANS_DAO: Request to retrieve transfer fulfilment hashes by transferId\n<color #FF0000><b>Error code:</b> 2003</color>
            activate TRANS_DAO
            TRANS_DAO -> DB: Request Transfer fulfilment \nduplicate message hashes
            hnote over DB #lightyellow
                SELET transferId, hash
                FROM **transferFulfilmentDuplicateCheck**
                WHERE transferId = request.params.id
            end note
            activate DB
            TRANS_DAO <- - DB: Return existing hashes
            deactivate DB
            TRANS_DAO - -> FULF_HANDLER: Return (list of) transfer fulfil messages hash(es)
            deactivate TRANS_DAO
            FULF_HANDLER -> FULF_HANDLER: Loop the list of returned hashes & compare \neach entry with the calculated message hash
            alt Hash matched
                FULF_HANDLER -> TRANS_DAO: Request to retrieve Transfer Fulfilment & Transfer state\n<color #FF0000><b>Error code:</b> 2003</color>
                activate TRANS_DAO
                TRANS_DAO -> DB: Request to retrieve \ntransferFulfilment & transferState
                hnote over DB #lightyellow
                    transferFulfilment
                    transferStateChange
                end note
                activate DB
                TRANS_DAO <- - DB: Return transferFulfilment & \ntransferState
                deactivate DB
                TRANS_DAO - -> FULF_HANDLER: Return Transfer Fulfilment & Transfer state
                deactivate TRANS_DAO
                alt transferFulfilment.isValid == 0
                    break
                        alt If type == 'fulfil'
                            note right of FULF_HANDLER #yellow
                            Message:
                            {
                                id: <ID>,
                                from: <transferHeaders.FSPIOP-Source>,
                                to: <transferHeaders.FSPIOP-Destination>,
                                type: application/json,
                                content: {
                                    headers: <transferHeaders>,
                                    payload: <transferMessage>
                                },
                                metadata: {
                                    event: {
                                        id: <uuid>,
                                        responseTo: <previous.uuid>,
                                        type: notification,
                                        action: fulfil-duplicate,
                                        createdAt: <timestamp>,
                                        state: {
                                            status: "fail",
                                            code: 1
                                        }
                                    }
                                }
                            }
                            end note
                            FULF_HANDLER -> TOPIC_NOTIFICATIONS: Publish Notification event for Payee - Modified Request\n<color #FF0000><b>Error codes:</b> 3106</color>
                            activate TOPIC_NOTIFICATIONS
                            deactivate TOPIC_NOTIFICATIONS
                        else If type == 'bulk-fulfil'
                            note right of FULF_HANDLER #yellow
                            Message:
                            {
                                id: <ID>,
                                from: <transferHeaders.FSPIOP-Source>,
                                to: <transferHeaders.FSPIOP-Destination>,
                                type: application/json,
                                content: {
                                    headers: <transferHeaders>,
                                    payload: <transferMessage>
                                },
                                metadata: {
                                    event: {
                                        id: <uuid>,
                                        responseTo: <previous.uuid>,
                                        type: bulk-processing,
                                        action: fulfil-duplicate,
                                        createdAt: <timestamp>,
                                        state: {
                                            status: "fail",
                                            code: 1
                                        }
                                    }
                                }
                            }
                            end note
                            FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish Notification event for Payee - Modified Request \n3106 to Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 3106</color>
                            activate TOPIC_BULK_PROCESSING
                            deactivate TOPIC_BULK_PROCESSING
                        end
                    end
                else transferState IN ['COMMITTED', 'ABORTED']
                    break
                        alt If type == 'fulfil'
                            ref over FULF_HANDLER, TOPIC_NOTIFICATIONS: Send notification to Participant (Payee) {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg 1.1.4.a]]} \n
                        else If type == 'bulk-fulfil'
                            note right of FULF_HANDLER #yellow
                            Message:
                            {
                                id: <ID>,
                                from: <transferHeaders.FSPIOP-Source>,
                                to: <transferHeaders.FSPIOP-Destination>,
                                type: application/json,
                                content: {
                                    headers: <transferHeaders>,
                                    payload: <transferMessage>
                                },
                                metadata: {
                                    event: {
                                        id: <uuid>,
                                        responseTo: <previous.uuid>,
                                        type: bulk-processing,
                                        action: fulfil-duplicate,
                                        createdAt: <timestamp>,
                                        state: {
                                            status: "success",
                                            code: 1
                                        }
                                    }
                                }
                            }
                            end note
                            FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish Notification event for Payee to Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 2003</color>
                            activate TOPIC_BULK_PROCESSING
                            deactivate TOPIC_BULK_PROCESSING
                        end
                    end
                else transferState NOT 'RESERVED'
                    break
                        FULF_HANDLER <-> FULF_HANDLER: <color Magenta><b>Reference: Failure in validation</b></color>\n<color #FF0000><b>Error code:</b> 2001</color>
                    end
                else
                    break
                        alt If type == 'fulfil'
                            FULF_HANDLER <-> FULF_HANDLER: Allow previous request to complete
                        else If type == 'bulk-fulfil'
                            note right of FULF_HANDLER #yellow
                            Message:
                            {
                                id: <ID>,
                                from: <transferHeaders.FSPIOP-Source>,
                                to: <transferHeaders.FSPIOP-Destination>,
                                type: application/json,
                                content: {
                                    headers: <transferHeaders>,
                                    payload: <transferMessage>
                                },
                                metadata: {
                                    event: {
                                        id: <uuid>,
                                        responseTo: <previous.uuid>,
                                        type: bulk-processing,
                                        action: fulfil-duplicate,
                                        createdAt: <timestamp>,
                                        state: {
                                            status: "success",
                                            code: 1
                                        }
                                    }
                                }
                            }
                            end note
                            FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish Notification event for Payee to Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 2003</color>
                            activate TOPIC_BULK_PROCESSING
                            deactivate TOPIC_BULK_PROCESSING
                        end
                    end
                end
            else Hash not matched
                FULF_HANDLER -> TRANS_DAO: Request to persist transfer hash\n<color #FF0000><b>Error codes:</b> 2003</color>
                activate TRANS_DAO
                TRANS_DAO -> DB: Persist hash
                hnote over DB #lightyellow
                    transferFulfilmentDuplicateCheck
                end note
                activate DB
                deactivate DB
                TRANS_DAO - -> FULF_HANDLER: Return success
                deactivate TRANS_DAO
            end
        end
        alt action=='reject' call made on PUT /transfers/{ID}
            FULF_HANDLER -> TRANS_DAO: Request information for the validate checks\n<color #FF0000><b>Error code:</b> 2003</color>
            activate TRANS_DAO
            TRANS_DAO -> DB: Fetch from database
            activate DB
            hnote over DB #lightyellow
                transfer
            end note
            DB - -> TRANS_DAO
            deactivate DB
            FULF_HANDLER <- - TRANS_DAO: Return transfer
            deactivate TRANS_DAO

            alt Fulfilment present in the PUT /transfers/{ID} message
                FULF_HANDLER ->FULF_HANDLER: Validate that Transfer.ilpCondition = SHA-256 (content.payload.fulfilment)\n<color #FF0000><b>Error code:</b> 2001</color>

                group Persist fulfilment
                    FULF_HANDLER -> TRANS_DAO: Persist fulfilment with the result of the above check (transferFulfilment.isValid)\n<color #FF0000><b>Error code:</b> 2003</color>
                    activate TRANS_DAO
                    TRANS_DAO -> DB: Persist to database
                    activate DB
                    deactivate DB
                    hnote over DB #lightyellow
                        transferFulfilment
                        transferExtension
                    end note
                    FULF_HANDLER <- - TRANS_DAO: Return success
                    deactivate TRANS_DAO
                end
            else Fulfilment NOT present in the PUT /transfers/{ID} message
                FULF_HANDLER ->FULF_HANDLER: Validate that transfer fulfilment message to Abort is valid\n<color #FF0000><b>Error code:</b> 2001</color>
                group Persist extensions
                    FULF_HANDLER -> TRANS_DAO: Persist extensionList elements\n<color #FF0000><b>Error code:</b> 2003</color>
                    activate TRANS_DAO
                    TRANS_DAO -> DB: Persist to database
                    activate DB
                    deactivate DB
                    hnote over DB #lightyellow
                        transferExtension
                    end note
                    FULF_HANDLER <- - TRANS_DAO: Return success
                    deactivate TRANS_DAO
                end
            end

            alt Transfer.ilpCondition validate successful OR generic validation successful
                group Persist Transfer State (with transferState='RECEIVED_REJECT')
                    FULF_HANDLER -> TRANS_DAO: Request to persist transfer state\n<color #FF0000><b>Error code:</b> 2003</color>
                    activate TRANS_DAO
                    TRANS_DAO -> DB: Persist transfer state
                    activate DB
                    hnote over DB #lightyellow
                        transferStateChange
                    end note
                    deactivate DB
                    TRANS_DAO - -> FULF_HANDLER: Return success
                end

                FULF_HANDLER -> FULF_HANDLER: Route & Publish Position event for Payer\n<color Magenta><b>Reference: Publish Position Reject event for Payer</b></color>

            else Validate Fulfil Transfer not successful or Generic validation failed
                break
                    FULF_HANDLER -> FULF_HANDLER: Publish event for Payee\n<color Magenta><b>Reference: Failure in validation</b></color>
                end
            end
        else action=='abort' Error callback
            alt Validation successful
                group Persist Transfer State (with transferState='RECEIVED_ERROR')
                    FULF_HANDLER -> TRANS_DAO: Request to persist transfer state & Error\n<color #FF0000><b>Error code:</b> 2003</color>
                    activate TRANS_DAO
                    TRANS_DAO -> DB: Persist transfer state & Error
                    activate DB
                    hnote over DB #lightyellow
                        transferStateChange
                        transferError
                        transferExtension
                    end note
                    deactivate DB
                    TRANS_DAO - -> FULF_HANDLER: Return success
                end

                FULF_HANDLER -> FULF_HANDLER: Error callback validated\n<color Magenta><b>Reference: Produce message for validated error callback</b></color>

            else Validate Transfer Error Message not successful
                break
                    FULF_HANDLER -> FULF_HANDLER: Notifications for failures\n<color Magenta><b>Reference: Validate Transfer Error Message not successful</b></color>
                end
            end
        end
    else Consume Batch Messages
        note left of FULF_HANDLER #lightblue
            To be delivered by future story
        end note
    end
end

group Reference: Validate Transfer Error Message not successful
    alt If type == 'bulk-fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: bulk-processing,
                    action: abort,
                    createdAt: <timestamp>,
                    state: {
                        status: "fail",
                        code: 1
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish Processing event for Payee to Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 2003</color>
        activate TOPIC_BULK_PROCESSING
        deactivate TOPIC_BULK_PROCESSING
    else If type == 'fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: fulfil,
                    action: abort,
                    createdAt: <timestamp>,
                    state: {
                        status: "fail",
                        code: 1
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_NOTIFICATIONS: Route & Publish Notification event for Payee
        activate TOPIC_NOTIFICATIONS
        deactivate TOPIC_NOTIFICATIONS
    end
end

group Reference: Produce message for validated error callback
    alt If type == 'bulk-fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: bulk-position,
                    action: abort,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Route & Publish Position event for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
    else If type == 'fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: position,
                    action: abort,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Route & Publish Position event for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
    end
end

group Reference: Failure in validation
    alt If type == 'bulk-fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: bulk-processing,
                    action: reject,
                    createdAt: <timestamp>,
                    state: {
                        status: "fail",
                        code: 1
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish processing event to the Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 2003</color>
        activate TOPIC_BULK_PROCESSING
        deactivate TOPIC_BULK_PROCESSING
    else If type == 'fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: fulfil,
                    action: reject,
                    createdAt: <timestamp>,
                    state: {
                        status: "fail",
                        code: 1
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_NOTIFICATIONS: Route & Publish Notification event for Payee
        activate TOPIC_NOTIFICATIONS
        deactivate TOPIC_NOTIFICATIONS
    end
end

group Reference: Publish Position Reject event for Payer
    alt If type == 'bulk-fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: bulk-position,
                    action: reject,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Route & Publish Position event for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
    else If type == 'fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: position,
                    action: reject,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Route & Publish Position event for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
    end
end

deactivate FULF_HANDLER
@enduml

PlantUML version 1.2018.05(Sat May 05 23:00:17 EEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Mac OS X
OS Version: 10.14.4
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>