<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1992px" preserveAspectRatio="none" style="width:1744px;height:1992px;" version="1.1" viewBox="0 0 1744 1992" width="1744px" zoomAndPan="magnify"><defs><filter height="300%" id="f17j3qe6zke6sa" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="819" x="463.75" y="23.5352">1.2.0. DFSP1 sends a Prepare Transfer request to DFSP2 (single message, includes individual transfers from Bulk)</text><rect fill="#D3D3D3" height="1946.6602" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="7" y="47.0566">Financial Service Providers</text><rect fill="#ADD8E6" height="1946.6602" style="stroke: #A80036; stroke-width: 1.0;" width="405" x="286.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="410.5" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="1946.6602" style="stroke: #A80036; stroke-width: 1.0;" width="1034" x="693.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="1160" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="640.5586" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340.5" y="753.9551"/><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="1704.3965" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="613.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="905.5" y="1247.6504"/><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="1704.3965" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1197.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="1704.3965" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="1690.3965" style="stroke: #000000; stroke-width: 2.0;" width="1700.5" x="33" y="170.7754"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="67" x2="67" y1="153.7754" y2="1878.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126" x2="126" y1="153.7754" y2="1878.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="345.5" x2="345.5" y1="153.7754" y2="1878.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="618.5" x2="618.5" y1="153.7754" y2="1878.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="764.5" x2="764.5" y1="153.7754" y2="1878.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="910.5" x2="910.5" y1="153.7754" y2="1878.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1202" x2="1202" y1="153.7754" y2="1878.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1353.5" x2="1353.5" y1="153.7754" y2="1878.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1513" x2="1513" y1="153.7754" y2="1878.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1673.5" x2="1673.5" y1="153.7754" y2="1878.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="134.334">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="150.8223">Payer</text><ellipse cx="67.5" cy="63.7988" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,71.7988 L67.5,98.7988 M54.5,79.7988 L80.5,79.7988 M67.5,98.7988 L54.5,113.7988 M67.5,98.7988 L80.5,113.7988 " fill="none" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="1890.707">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="1907.1953">Payer</text><ellipse cx="67.5" cy="1920.1484" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,1928.1484 L67.5,1955.1484 M54.5,1936.1484 L80.5,1936.1484 M67.5,1955.1484 L54.5,1970.1484 M67.5,1955.1484 L80.5,1970.1484 " fill="none" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="134.334">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="150.8223">Payee</text><ellipse cx="126.5" cy="63.7988" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,71.7988 L126.5,98.7988 M113.5,79.7988 L139.5,79.7988 M126.5,98.7988 L113.5,113.7988 M126.5,98.7988 L139.5,113.7988 " fill="none" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="1890.707">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="1907.1953">Payee</text><ellipse cx="126.5" cy="1920.1484" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,1928.1484 L126.5,1955.1484 M113.5,1936.1484 L139.5,1936.1484 M126.5,1955.1484 L113.5,1970.1484 M126.5,1955.1484 L139.5,1970.1484 " fill="none" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="290.5" y="150.8223">ML API Adapter</text><path d="M325,109.2871 L325,133.2871 M325,121.2871 L342,121.2871 " fill="none" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="354" cy="121.2871" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="290.5" y="1890.707">ML API Adapter</text><path d="M325,1897.6602 L325,1921.6602 M325,1909.6602 L342,1909.6602 " fill="none" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="354" cy="1909.6602" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="549.5" y="134.334">ML API Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="588.5" y="150.8223">Handler</text><ellipse cx="618.5" cy="104.7988" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="614.5,92.7988,620.5,87.7988,618.5,92.7988,620.5,97.7988,614.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="549.5" y="1890.707">ML API Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="588.5" y="1907.1953">Handler</text><ellipse cx="618.5" cy="1926.1484" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="614.5,1914.1484,620.5,1909.1484,618.5,1914.1484,620.5,1919.1484,614.5,1914.1484" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="697.5" y="150.8223">Central Service API</text><path d="M744,109.2871 L744,133.2871 M744,121.2871 L761,121.2871 " fill="none" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="773" cy="121.2871" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="697.5" y="1890.707">Central Service API</text><path d="M744,1897.6602 L744,1921.6602 M744,1909.6602 L761,1909.6602 " fill="none" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="773" cy="1909.6602" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="845.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="841.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="885.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="848.5" y="138.8223">transfer-prepare</text><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="845.5" y="1877.1719"/><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="841.5" y="1881.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="885.5" y="1901.707">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="848.5" y="1918.1953">transfer-prepare</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1144" y="150.8223">Prepare Handler</text><ellipse cx="1202.5" cy="121.2871" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1198.5,109.2871,1204.5,104.2871,1202.5,109.2871,1204.5,114.2871,1198.5,109.2871" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1144" y="1890.707">Prepare Handler</text><ellipse cx="1202.5" cy="1909.6602" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1198.5,1897.6602,1204.5,1892.6602,1202.5,1897.6602,1204.5,1902.6602,1198.5,1897.6602" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1287.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1283.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1328.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1290.5" y="138.8223">transfer-position</text><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1287.5" y="1877.1719"/><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1283.5" y="1881.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1328.5" y="1901.707">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1290.5" y="1918.1953">transfer-position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1454" y="150.8223">Position Handler</text><ellipse cx="1513.5" cy="121.2871" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1509.5,109.2871,1515.5,104.2871,1513.5,109.2871,1515.5,114.2871,1509.5,109.2871" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1454" y="1890.707">Position Handler</text><ellipse cx="1513.5" cy="1909.6602" fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1509.5,1897.6602,1515.5,1892.6602,1513.5,1897.6602,1515.5,1902.6602,1509.5,1897.6602" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1627.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1623.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1648.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1630.5" y="138.8223">notification</text><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1627.5" y="1877.1719"/><rect fill="#FEFECE" filter="url(#f17j3qe6zke6sa)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1623.5" y="1881.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1648.5" y="1901.707">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1630.5" y="1918.1953">notification</text><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="640.5586" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340.5" y="753.9551"/><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="1704.3965" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="613.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="905.5" y="1247.6504"/><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="1704.3965" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1197.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="1704.3965" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1508.5" y="163.7754"/><path d="M33,170.7754 L412,170.7754 L412,177.7754 L402,187.7754 L33,187.7754 L33,170.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1690.3965" style="stroke: #000000; stroke-width: 2.0;" width="1700.5" x="33" y="170.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="334" x="48" y="184.3438">DFSP1 sends a Prepare Transfer request to DFSP2</text><path d="M72,193.0859 L72,723.0859 L413,723.0859 L413,203.0859 L403,193.0859 L72,193.0859 " fill="#FFFF00" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M403,193.0859 L403,203.0859 L413,203.0859 L403,193.0859 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="78" y="210.6543">Headers - transferHeaders: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="94" y="225.9648">Content-Length: &lt;Content-Length&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="94" y="241.2754">Content-Type: &lt;Content-Type&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="94" y="256.5859">Date: &lt;Date&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="94" y="271.8965">X-Forwarded-For: &lt;X-Forwarded-For&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="94" y="287.207">FSPIOP-Source: &lt;FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="94" y="302.5176">FSPIOP-Destination: &lt;FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="94" y="317.8281">FSPIOP-Encryption: &lt;FSPIOP-Encryption&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="94" y="333.1387">FSPIOP-Signature: &lt;FSPIOP-Signature&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="94" y="348.4492">FSPIOP-URI: &lt;FSPIOP-URI&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="94" y="363.7598">FSPIOP-HTTP-Method: &lt;FSPIOP-HTTP-Method&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="78" y="379.0703">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="82" y="394.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="78" y="409.6914">Payload - transferMessage:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="78" y="425.002">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="94" y="440.3125">"transferId": &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="94" y="455.623">"payeeFsp": dfsp2,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="94" y="470.9336">"payerFsp": dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="94" y="486.2441">"amount": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="110" y="501.5547">"currency": "AED",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="110" y="516.8652">"amount": "string"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="94" y="532.1758">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="94" y="547.4863">"ilpPacket": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="94" y="562.7969">"condition": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="94" y="578.1074">"expiration": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="94" y="593.418">"extensionList": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="110" y="608.7285">"extension": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="126" y="624.0391">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="142" y="639.3496">"key": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="142" y="654.6602">"value": "string"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="126" y="669.9707">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="110" y="685.2813">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="94" y="700.5918">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="78" y="715.9023">}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="328.5" y1="753.9551" y2="749.9551"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="328.5" y1="753.9551" y2="757.9551"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="67.5" x2="339.5" y1="753.9551" y2="753.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="74.5" y="749.2129">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="87.5" y="749.2129">POST - /transfers</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="350.5" x2="392.5" y1="813.8867" y2="813.8867"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="392.5" x2="392.5" y1="813.8867" y2="826.8867"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="351.5" x2="392.5" y1="826.8867" y2="826.8867"/><polygon fill="#A80036" points="361.5,822.8867,351.5,826.8867,361.5,830.8867,357.5,826.8867" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="357.5" y="793.834">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="370.5" y="778.5234">Validate incoming token &amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="370.5" y="793.834">originator matching Payer</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="370.5" y="809.1445">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="454.5" y="809.1445">3000-3002, 3100-3107</text><path d="M355,839.8867 L355,1201.8867 L617,1201.8867 L617,849.8867 L607,839.8867 L355,839.8867 " fill="#FFFF00" filter="url(#f17j3qe6zke6sa)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M607,839.8867 L607,849.8867 L617,849.8867 L607,839.8867 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="361" y="857.4551">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="361" y="872.7656">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="377" y="888.0762">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="377" y="903.3867">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="377" y="918.6973">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="377" y="934.0078">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="377" y="949.3184">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="393" y="964.6289">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="393" y="979.9395">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="377" y="995.25">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="377" y="1010.5605">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="393" y="1025.8711">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="409" y="1041.1816">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="409" y="1056.4922">type: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="409" y="1071.8027">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="409" y="1087.1133">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="409" y="1102.4238">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="425" y="1117.7344">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="425" y="1133.0449">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="409" y="1148.3555">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="393" y="1163.666">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="377" y="1178.9766">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="361" y="1194.2871">}</text><polygon fill="#A80036" points="893.5,1243.6504,903.5,1247.6504,893.5,1251.6504,897.5,1247.6504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350.5" x2="899.5" y1="1247.6504" y2="1247.6504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="357.5" y="1235.2529">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="370.5" y="1227.5977">Route &amp; Publish Prepare event for Payer</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="370.5" y="1242.9082">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="447.5" y="1242.9082">2003</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="915.5" x2="957.5" y1="1307.582" y2="1307.582"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="957.5" x2="957.5" y1="1307.582" y2="1320.582"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="916.5" x2="957.5" y1="1320.582" y2="1320.582"/><polygon fill="#A80036" points="926.5,1316.582,916.5,1320.582,926.5,1324.582,922.5,1320.582" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="922.5" y="1287.5293">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="935.5" y="1272.2188">Ensure event is replicated as configured</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="935.5" y="1287.5293">(ACKS=all)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="935.5" y="1302.8398">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1012.5" y="1302.8398">2003</text><polygon fill="#A80036" points="361.5,1361.2031,351.5,1365.2031,361.5,1369.2031,357.5,1365.2031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="355.5" x2="909.5" y1="1365.2031" y2="1365.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="367.5" y="1352.8057">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="380.5" y="1345.1504">Respond replication acknowledgements</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="380.5" y="1360.4609">have been received</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="67.5" x2="77.5" y1="1394.5137" y2="1390.5137"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="67.5" x2="77.5" y1="1394.5137" y2="1398.5137"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="67.5" x2="344.5" y1="1394.5137" y2="1394.5137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="84.5" y="1389.7715">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="97.5" y="1389.7715">Respond HTTP - 202 (Accepted)</text><polygon fill="#A80036" points="921.5,1444.8242,911.5,1448.8242,921.5,1452.8242,917.5,1448.8242" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="915.5" x2="1196.5" y1="1448.8242" y2="1448.8242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="927.5" y="1444.082">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="940.5" y="1444.082">Consume message</text><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="584" x="838.5" y="1456.8242"/><polygon fill="#EEEEEE" points="838.5,1456.8242,902.5,1456.8242,902.5,1463.8242,892.5,1473.8242,838.5,1473.8242,838.5,1456.8242" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="851.5" y="1471.3926">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="1051.5" y="1490.3926">Prepare Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1055.5" y="1505.7031"/><polygon fill="#A80036" points="1341.5,1535.0664,1351.5,1539.0664,1341.5,1543.0664,1345.5,1539.0664" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1207.5" x2="1347.5" y1="1539.0664" y2="1539.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1214.5" y="1534.3242">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1227.5" y="1534.3242">Produce message</text><polygon fill="#A80036" points="1364.5,1589.377,1354.5,1593.377,1364.5,1597.377,1360.5,1593.377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1358.5" x2="1507.5" y1="1593.377" y2="1593.377"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1370.5" y="1588.6348">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1383.5" y="1588.6348">Consume message</text><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="291.5" x="1280.5" y="1601.377"/><polygon fill="#EEEEEE" points="1280.5,1601.377,1344.5,1601.377,1344.5,1608.377,1334.5,1618.377,1280.5,1618.377,1280.5,1601.377" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1293.5" y="1615.9453">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="1344.75" y="1634.9453">Position Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1348.75" y="1650.2559"/><polygon fill="#A80036" points="1661.5,1679.6191,1671.5,1683.6191,1661.5,1687.6191,1665.5,1683.6191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1518.5" x2="1667.5" y1="1683.6191" y2="1683.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1525.5" y="1678.877">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1547.5" y="1678.877">Produce message</text><polygon fill="#A80036" points="1661.5,1733.9297,1671.5,1737.9297,1661.5,1741.9297,1665.5,1737.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="623.5" x2="1667.5" y1="1737.9297" y2="1737.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="630.5" y="1733.1875">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="652.5" y="1733.1875">Consume message</text><rect fill="#FFFFFF" filter="url(#f17j3qe6zke6sa)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="1623.5" x="99" y="1745.9297"/><polygon fill="#EEEEEE" points="99,1745.9297,163,1745.9297,163,1752.9297,153,1762.9297,99,1762.9297,99,1745.9297" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="112" y="1760.498">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="791.75" y="1779.498">Send notification to Participant (Payee)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="795.75" y="1794.8086"/><polygon fill="#A80036" points="137.5,1824.1719,127.5,1828.1719,137.5,1832.1719,133.5,1828.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131.5" x2="612.5" y1="1828.1719" y2="1828.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="143.5" y="1823.4297">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="165.5" y="1823.4297">Send callback notification</text><!--
@startuml
title 1.2.0. DFSP1 sends a Prepare Transfer request to DFSP2 (single message, includes individual transfers from Bulk)

autonumber


actor "DFSP1\nPayer" as DFSP1
actor "DFSP2\nPayee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API Notification \nHandler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "topic-\ntransfer-prepare" as TOPIC_TRANSFER_PREPARE
control "Prepare Handler" as PREP_HANDLER
collections "topic-\ntransfer-position" as TOPIC_TRANSFER_POSITION
control "Position Handler" as POS_HANDLER
collections "topic-\nnotification" as TOPIC_NOTIFICATIONS

box "Financial Service Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
	participant TOPIC_TRANSFER_PREPARE
    participant PREP_HANDLER
    participant TOPIC_TRANSFER_POSITION
    participant POS_HANDLER
    participant TOPIC_NOTIFICATIONS
end box

activate NOTIFY_HANDLER
activate PREP_HANDLER
activate POS_HANDLER
group DFSP1 sends a Prepare Transfer request to DFSP2
    note right of DFSP1 #yellow
        Headers - transferHeaders: {
            Content-Length: <Content-Length>,
            Content-Type: <Content-Type>,
            Date: <Date>,
            X-Forwarded-For: <X-Forwarded-For>,
            FSPIOP-Source: <FSPIOP-Source>,
            FSPIOP-Destination: <FSPIOP-Destination>,
            FSPIOP-Encryption: <FSPIOP-Encryption>,
            FSPIOP-Signature: <FSPIOP-Signature>,
            FSPIOP-URI: <FSPIOP-URI>,
            FSPIOP-HTTP-Method: <FSPIOP-HTTP-Method>
        }

        Payload - transferMessage:
        {
            "transferId": <uuid>,
            "payeeFsp": dfsp2,
            "payerFsp": dfsp1,
            "amount": {
                "currency": "AED",
                "amount": "string"
            },
            "ilpPacket": "string",
            "condition": "string",
            "expiration": "string",
            "extensionList": {
                "extension": [
                    {
                        "key": "string",
                        "value": "string"
                    }
                ]
            }
        }
    end note
    DFSP1 ->> MLAPI: POST - /transfers
    activate MLAPI
    MLAPI -> MLAPI: Validate incoming token & \noriginator matching Payer\n<color #FF0000><b>Error codes:</b> 3000-3002, 3100-3107</color>
    note right of MLAPI #yellow
        Message:
        {
            id: <transferMessage.transferId>
            from: <transferMessage.payerFsp>,
            to: <transferMessage.payeeFsp>,
            type: application/json
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    type: prepare,
                    action: prepare,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    MLAPI -> TOPIC_TRANSFER_PREPARE: Route & Publish Prepare event for Payer\n<color #FF0000><b>Error code:</b> 2003</color>
    activate TOPIC_TRANSFER_PREPARE
    TOPIC_TRANSFER_PREPARE <-> TOPIC_TRANSFER_PREPARE: Ensure event is replicated as configured \n(ACKS=all)\n<color #FF0000><b>Error code:</b> 2003</color>
    TOPIC_TRANSFER_PREPARE - -> MLAPI: Respond replication acknowledgements \nhave been received
    deactivate TOPIC_TRANSFER_PREPARE
    MLAPI - ->> DFSP1: Respond HTTP - 202 (Accepted)
    deactivate MLAPI
    |||
    TOPIC_TRANSFER_PREPARE <- PREP_HANDLER: Consume message
    ref over TOPIC_TRANSFER_PREPARE, PREP_HANDLER, TOPIC_TRANSFER_POSITION :  Prepare Handler Consume\n
    PREP_HANDLER -> TOPIC_TRANSFER_POSITION: Produce message
    |||
    TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume message
    ref over TOPIC_TRANSFER_POSITION, POS_HANDLER : Position Handler Consume\n
    POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    ref over DFSP2, TOPIC_NOTIFICATIONS : Send notification to Participant (Payee)\n
    NOTIFY_HANDLER -> DFSP2: Send callback notification
    |||
end
deactivate POS_HANDLER
deactivate PREP_HANDLER
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2018.05(Sat May 05 23:00:17 EEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Mac OS X
OS Version: 10.14.4
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>