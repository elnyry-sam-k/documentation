<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2802px" preserveAspectRatio="none" style="width:2338px;height:2802px;" version="1.1" viewBox="0 0 2338 2802" width="2338px" zoomAndPan="magnify"><defs><filter height="300%" id="fjsustprpwr89" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="374" x="983.25" y="23.5352">2.1.0. DFSP2 sends a Fulfil Success Transfer request</text><rect fill="#D3D3D3" height="2756.8867" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="7" y="47.0566">Financial Service Providers</text><rect fill="#ADD8E6" height="2756.8867" style="stroke: #A80036; stroke-width: 1.0;" width="407.5" x="314.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="439.75" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="2756.8867" style="stroke: #A80036; stroke-width: 1.0;" width="1587.5" x="724" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="1467.25" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="640.5586" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="368.5" y="891.75"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2514.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="641.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="912.5" y="1385.4453"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2515.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2514.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1434.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2514.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1763.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2514.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2092.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2500.623" style="stroke: #000000; stroke-width: 2.0;" width="2304.5" x="23" y="170.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="1244.5" x="1073" y="1637.5508"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="1244.5" x="1073" y="1684.1719"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="606.5" x="1399.5" y="1857.6797"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="606.5" x="1399.5" y="1904.3008"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2284.5" x="33" y="2305.9824"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2225.5" x="92" y="2506.8457"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="67" x2="67" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126" x2="126" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="373.5" x2="373.5" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="646" x2="646" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="795" x2="795" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="917" x2="917" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1119" x2="1119" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1270.5" x2="1270.5" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1439.5" x2="1439.5" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1599.5" x2="1599.5" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1768" x2="1768" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1928" x2="1928" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2097" x2="2097" y1="153.7754" y2="2688.3984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2257.5" x2="2257.5" y1="153.7754" y2="2688.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="134.334">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="150.8223">Payer</text><ellipse cx="67.5" cy="63.7988" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,71.7988 L67.5,98.7988 M54.5,79.7988 L80.5,79.7988 M67.5,98.7988 L54.5,113.7988 M67.5,98.7988 L80.5,113.7988 " fill="none" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="2700.9336">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="2717.4219">Payer</text><ellipse cx="67.5" cy="2730.375" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,2738.375 L67.5,2765.375 M54.5,2746.375 L80.5,2746.375 M67.5,2765.375 L54.5,2780.375 M67.5,2765.375 L80.5,2780.375 " fill="none" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="134.334">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="150.8223">Payee</text><ellipse cx="126.5" cy="63.7988" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,71.7988 L126.5,98.7988 M113.5,79.7988 L139.5,79.7988 M126.5,98.7988 L113.5,113.7988 M126.5,98.7988 L139.5,113.7988 " fill="none" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="2700.9336">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="2717.4219">Payee</text><ellipse cx="126.5" cy="2730.375" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,2738.375 L126.5,2765.375 M113.5,2746.375 L139.5,2746.375 M126.5,2765.375 L113.5,2780.375 M126.5,2765.375 L139.5,2780.375 " fill="none" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="318.5" y="150.8223">ML API Adapter</text><path d="M353,109.2871 L353,133.2871 M353,121.2871 L370,121.2871 " fill="none" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="382" cy="121.2871" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="318.5" y="2700.9336">ML API Adapter</text><path d="M353,2707.8867 L353,2731.8867 M353,2719.8867 L370,2719.8867 " fill="none" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="382" cy="2719.8867" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="619" y="134.334">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="575" y="150.8223">Notification Handler</text><ellipse cx="646.5" cy="104.7988" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="642.5,92.7988,648.5,87.7988,646.5,92.7988,648.5,97.7988,642.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="619" y="2700.9336">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="575" y="2717.4219">Notification Handler</text><ellipse cx="646.5" cy="2736.375" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="642.5,2724.375,648.5,2719.375,646.5,2724.375,648.5,2729.375,642.5,2724.375" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="728" y="150.8223">Central Service API</text><path d="M774.5,109.2871 L774.5,133.2871 M774.5,121.2871 L791.5,121.2871 " fill="none" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="803.5" cy="121.2871" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="728" y="2700.9336">Central Service API</text><path d="M774.5,2707.8867 L774.5,2731.8867 M774.5,2719.8867 L791.5,2719.8867 " fill="none" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="803.5" cy="2719.8867" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="876" y="97.7988"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="872" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="892.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="879" y="138.8223">bulk-fulfil</text><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="876" y="2687.3984"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="872" y="2691.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="892.5" y="2711.9336">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="879" y="2728.4219">bulk-fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1083" y="134.334">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1089.5" y="150.8223">Handler</text><ellipse cx="1119.5" cy="104.7988" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1115.5,92.7988,1121.5,87.7988,1119.5,92.7988,1121.5,97.7988,1115.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1083" y="2700.9336">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1089.5" y="2717.4219">Handler</text><ellipse cx="1119.5" cy="2736.375" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1115.5,2724.375,1121.5,2719.375,1119.5,2724.375,1121.5,2729.375,1115.5,2724.375" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1242.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1238.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1245.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1251" y="138.8223">fulfil</text><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1242.5" y="2687.3984"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1238.5" y="2691.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1245.5" y="2711.9336">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1251" y="2728.4219">fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1417.5" y="134.334">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1409.5" y="150.8223">Handler</text><ellipse cx="1439.5" cy="104.7988" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1435.5,92.7988,1441.5,87.7988,1439.5,92.7988,1441.5,97.7988,1435.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1417.5" y="2700.9336">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1409.5" y="2717.4219">Handler</text><ellipse cx="1439.5" cy="2736.375" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1435.5,2724.375,1441.5,2719.375,1439.5,2724.375,1441.5,2729.375,1435.5,2724.375" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1533.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1529.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1574.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1536.5" y="138.8223">transfer-position</text><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1533.5" y="2687.3984"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1529.5" y="2691.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1574.5" y="2711.9336">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1536.5" y="2728.4219">transfer-position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="1736" y="134.334">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1738.5" y="150.8223">Handler</text><ellipse cx="1768.5" cy="104.7988" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1764.5,92.7988,1770.5,87.7988,1768.5,92.7988,1770.5,97.7988,1764.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="1736" y="2700.9336">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1738.5" y="2717.4219">Handler</text><ellipse cx="1768.5" cy="2736.375" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1764.5,2724.375,1770.5,2719.375,1768.5,2724.375,1770.5,2729.375,1764.5,2724.375" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1865" y="97.7988"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1861" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1903.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1868" y="138.8223">bulk-processing</text><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1865" y="2687.3984"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1861" y="2691.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1903.5" y="2711.9336">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1868" y="2728.4219">bulk-processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="2041" y="134.334">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2067.5" y="150.8223">Handler</text><ellipse cx="2097.5" cy="104.7988" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2093.5,92.7988,2099.5,87.7988,2097.5,92.7988,2099.5,97.7988,2093.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="2041" y="2700.9336">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2067.5" y="2717.4219">Handler</text><ellipse cx="2097.5" cy="2736.375" fill="#FEFECE" filter="url(#fjsustprpwr89)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2093.5,2724.375,2099.5,2719.375,2097.5,2724.375,2099.5,2729.375,2093.5,2724.375" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2211.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2207.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2232.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2214.5" y="138.8223">notification</text><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2211.5" y="2687.3984"/><rect fill="#FEFECE" filter="url(#fjsustprpwr89)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2207.5" y="2691.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2232.5" y="2711.9336">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2214.5" y="2728.4219">notification</text><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="640.5586" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="368.5" y="891.75"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2514.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="641.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="912.5" y="1385.4453"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2515.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1114.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2514.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1434.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2514.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1763.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="2514.623" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2092.5" y="163.7754"/><path d="M23,170.7754 L471,170.7754 L471,177.7754 L461,187.7754 L23,187.7754 L23,170.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="2500.623" style="stroke: #000000; stroke-width: 2.0;" width="2304.5" x="23" y="170.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="403" x="38" y="184.3438">DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1</text><path d="M131,193.0859 L131,861.0859 L482,861.0859 L482,203.0859 L472,193.0859 L131,193.0859 " fill="#FFFF00" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M472,193.0859 L472,203.0859 L482,203.0859 L472,193.0859 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="137" y="210.6543">Headers - transferHeaders: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="153" y="225.9648">Content-Length: &lt;Content-Length&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="153" y="241.2754">Content-Type: &lt;Content-Type&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="153" y="256.5859">Date: &lt;Date&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="153" y="271.8965">X-Forwarded-For: &lt;X-Forwarded-For&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="153" y="287.207">FSPIOP-Source: &lt;FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="153" y="302.5176">FSPIOP-Destination: &lt;FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="153" y="317.8281">FSPIOP-Encryption: &lt;FSPIOP-Encryption&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="153" y="333.1387">FSPIOP-Signature: &lt;FSPIOP-Signature&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="153" y="348.4492">FSPIOP-URI: &lt;FSPIOP-URI&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="153" y="363.7598">FSPIOP-HTTP-Method: &lt;FSPIOP-HTTP-Method&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="379.0703">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="141" y="394.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="137" y="409.6914">Payload - bulkTransferMessage:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="425.002">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="153" y="440.3125">“completedTimestamp": &lt;completedTimeStamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="264" x="153" y="455.623">“bulkTransferState”: &lt;bulkTransferState&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="153" y="470.9336">“individualTransferResults”:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="153" y="486.2441">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="501.5547">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="185" y="516.8652">"transferId": &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="185" y="532.1758">“fulfilment”: &lt;ilpCondition&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="185" y="547.4863">"extensionList":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="562.7969">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="201" y="578.1074">"extension":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="201" y="593.418">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="217" y="608.7285">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="233" y="624.0391">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="233" y="639.3496">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="217" y="654.6602">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="201" y="669.9707">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="685.2813">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="700.5918">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="153" y="715.9023">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="153" y="731.2129">"extensionList": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="169" y="746.5234">"extension": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="761.834">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="201" y="777.1445">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="201" y="792.4551">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="807.7656">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="823.0762">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="153" y="838.3867">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="853.6973">}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="366.5" x2="356.5" y1="891.75" y2="887.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="366.5" x2="356.5" y1="891.75" y2="895.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="367.5" y1="891.75" y2="891.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="133.5" y="887.0078">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="146.5" y="887.0078">PUT - /bulkTransfers/&lt;ID&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="420.5" y1="951.6816" y2="951.6816"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="420.5" x2="420.5" y1="951.6816" y2="964.6816"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="420.5" y1="964.6816" y2="964.6816"/><polygon fill="#A80036" points="389.5,960.6816,379.5,964.6816,389.5,968.6816,385.5,964.6816" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="931.6289">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="398.5" y="916.3184">Validate incoming message &amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="398.5" y="931.6289">originator matching Payee</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="398.5" y="946.9395">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="482.5" y="946.9395">3000-3002, 3100-3107</text><path d="M383,977.6816 L383,1339.6816 L692,1339.6816 L692,987.6816 L682,977.6816 L383,977.6816 " fill="#FFFF00" filter="url(#fjsustprpwr89)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M682,977.6816 L682,987.6816 L692,987.6816 L682,977.6816 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="389" y="995.25">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="389" y="1010.5605">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="405" y="1025.8711">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="405" y="1041.1816">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="405" y="1056.4922">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="405" y="1071.8027">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="405" y="1087.1133">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="421" y="1102.4238">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="421" y="1117.7344">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="405" y="1133.0449">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="405" y="1148.3555">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="421" y="1163.666">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="437" y="1178.9766">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="437" y="1194.2871">type: bulk-fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="437" y="1209.5977">action: bulk-commit,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="437" y="1224.9082">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="437" y="1240.2188">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="453" y="1255.5293">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="453" y="1270.8398">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="437" y="1286.1504">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="421" y="1301.4609">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="405" y="1316.7715">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="389" y="1332.082">}</text><polygon fill="#A80036" points="900.5,1381.4453,910.5,1385.4453,900.5,1389.4453,904.5,1385.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="906.5" y1="1385.4453" y2="1385.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="1373.0479">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="398.5" y="1365.3926">Route &amp; Publish Bulk Fulfil event for Payee</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="398.5" y="1380.7031">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="475.5" y="1380.7031">2003</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="922.5" x2="964.5" y1="1445.377" y2="1445.377"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="964.5" x2="964.5" y1="1445.377" y2="1458.377"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="923.5" x2="964.5" y1="1458.377" y2="1458.377"/><polygon fill="#A80036" points="933.5,1454.377,923.5,1458.377,933.5,1462.377,929.5,1458.377" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="929.5" y="1425.3242">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="942.5" y="1410.0137">Ensure event is replicated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="942.5" y="1425.3242">as configured (ACKS=all)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="942.5" y="1440.6348">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1019.5" y="1440.6348">2003</text><polygon fill="#A80036" points="389.5,1498.998,379.5,1502.998,389.5,1506.998,385.5,1502.998" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="383.5" x2="916.5" y1="1502.998" y2="1502.998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="395.5" y="1490.6006">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="408.5" y="1482.9453">Respond replication acknowledgements</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="408.5" y="1498.2559">have been received</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="136.5" y1="1532.3086" y2="1528.3086"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="136.5" y1="1532.3086" y2="1536.3086"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="126.5" x2="372.5" y1="1532.3086" y2="1532.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="143.5" y="1527.5664">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="156.5" y="1527.5664">Respond HTTP - 200 (OK)</text><polygon fill="#A80036" points="928.5,1557.6191,918.5,1561.6191,928.5,1565.6191,924.5,1561.6191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922.5" x2="1113.5" y1="1561.6191" y2="1561.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="934.5" y="1556.877">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="947.5" y="1556.877">Consume message</text><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="432.5" x="869" y="1569.6191"/><polygon fill="#EEEEEE" points="869,1569.6191,933,1569.6191,933,1576.6191,923,1586.6191,869,1586.6191,869,1569.6191" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="882" y="1584.1875">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="997.75" y="1603.1875">Bulk Fulfil Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1001.75" y="1618.498"/><path d="M1073,1637.5508 L1135,1637.5508 L1135,1644.5508 L1125,1654.5508 L1073,1654.5508 L1073,1637.5508 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="1244.5" x="1073" y="1637.5508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1088" y="1651.1191">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1150" y="1650.1855">[Success]</text><polygon fill="#A80036" points="1258.5,1672.1719,1268.5,1676.1719,1258.5,1680.1719,1262.5,1676.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1124.5" x2="1264.5" y1="1676.1719" y2="1676.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1131.5" y="1671.4297">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1144.5" y="1671.4297">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1073" x2="2317.5" y1="1685.1719" y2="1685.1719"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1078" y="1695.8066">[Failure]</text><polygon fill="#A80036" points="2245.5,1716.4375,2255.5,1720.4375,2245.5,1724.4375,2249.5,1720.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1124.5" x2="2251.5" y1="1720.4375" y2="1720.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1131.5" y="1715.6953">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1144.5" y="1715.6953">Produce message</text><polygon fill="#A80036" points="1281.5,1777.748,1271.5,1781.748,1281.5,1785.748,1277.5,1781.748" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1275.5" x2="1433.5" y1="1781.748" y2="1781.748"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1287.5" y="1777.0059">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1309.5" y="1777.0059">Consume message</text><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="433" x="1235.5" y="1789.748"/><polygon fill="#EEEEEE" points="1235.5,1789.748,1299.5,1789.748,1299.5,1796.748,1289.5,1806.748,1235.5,1806.748,1235.5,1789.748" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1248.5" y="1804.3164">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="1349" y="1823.3164">Fulfil Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1353" y="1838.627"/><path d="M1399.5,1857.6797 L1461.5,1857.6797 L1461.5,1864.6797 L1451.5,1874.6797 L1399.5,1874.6797 L1399.5,1857.6797 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="606.5" x="1399.5" y="1857.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1414.5" y="1871.248">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1476.5" y="1870.3145">[Success]</text><polygon fill="#A80036" points="1587.5,1892.3008,1597.5,1896.3008,1587.5,1900.3008,1591.5,1896.3008" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1444.5" x2="1593.5" y1="1896.3008" y2="1896.3008"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1451.5" y="1891.5586">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1473.5" y="1891.5586">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1399.5" x2="2006" y1="1905.3008" y2="1905.3008"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1404.5" y="1915.9355">[Failure]</text><polygon fill="#A80036" points="1916.5,1936.5664,1926.5,1940.5664,1916.5,1944.5664,1920.5,1940.5664" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1444.5" x2="1922.5" y1="1940.5664" y2="1940.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1451.5" y="1935.8242">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1473.5" y="1935.8242">Produce message</text><polygon fill="#A80036" points="1610.5,1997.877,1600.5,2001.877,1610.5,2005.877,1606.5,2001.877" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1604.5" x2="1762.5" y1="2001.877" y2="2001.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1616.5" y="1997.1348">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1638.5" y="1997.1348">Consume message</text><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="468.5" x="1526.5" y="2009.877"/><polygon fill="#EEEEEE" points="1526.5,2009.877,1590.5,2009.877,1590.5,2016.877,1580.5,2026.877,1526.5,2026.877,1526.5,2009.877" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1539.5" y="2024.4453">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="1648.25" y="2043.4453">Position Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1652.25" y="2058.7559"/><polygon fill="#A80036" points="1916.5,2088.1191,1926.5,2092.1191,1916.5,2096.1191,1920.5,2092.1191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1773.5" x2="1922.5" y1="2092.1191" y2="2092.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1780.5" y="2087.377">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1802.5" y="2087.377">Produce message</text><polygon fill="#A80036" points="1939.5,2142.4297,1929.5,2146.4297,1939.5,2150.4297,1935.5,2146.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1933.5" x2="2091.5" y1="2146.4297" y2="2146.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1945.5" y="2141.6875">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1967.5" y="2141.6875">Consume message</text><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="448.5" x="1858" y="2154.4297"/><polygon fill="#EEEEEE" points="1858,2154.4297,1922,2154.4297,1922,2161.4297,1912,2171.4297,1858,2171.4297,1858,2154.4297" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1871" y="2168.998">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="1969.75" y="2187.998">Position Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1973.75" y="2203.3086"/><polygon fill="#A80036" points="2245.5,2232.6719,2255.5,2236.6719,2245.5,2240.6719,2249.5,2236.6719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2102.5" x2="2251.5" y1="2236.6719" y2="2236.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2109.5" y="2231.9297">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="2131.5" y="2231.9297">Produce message</text><polygon fill="#A80036" points="2245.5,2286.9824,2255.5,2290.9824,2245.5,2294.9824,2249.5,2290.9824" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="2251.5" y1="2290.9824" y2="2290.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2286.2402">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="680.5" y="2286.2402">Consume message</text><path d="M33,2305.9824 L100,2305.9824 L100,2312.9824 L90,2322.9824 L33,2322.9824 L33,2305.9824 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2284.5" x="33" y="2305.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="48" y="2319.5508">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="115" y="2318.6172">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="2266.5" x="40" y="2348.293"/><polygon fill="#EEEEEE" points="40,2348.293,104,2348.293,104,2355.293,94,2365.293,40,2365.293,40,2348.293" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="53" y="2362.8613">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="1055.25" y="2381.8613">Send notification to Participant (Payer)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1059.25" y="2397.1719"/><polygon fill="#A80036" points="78.5,2426.5352,68.5,2430.5352,78.5,2434.5352,74.5,2430.5352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="640.5" y1="2430.5352" y2="2430.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="2425.793">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="106.5" y="2425.793">Send callback notification</text><polygon fill="#A80036" points="2245.5,2487.8457,2255.5,2491.8457,2245.5,2495.8457,2249.5,2491.8457" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651.5" x2="2251.5" y1="2491.8457" y2="2491.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="658.5" y="2487.1035">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="680.5" y="2487.1035">Consume message</text><path d="M92,2506.8457 L159,2506.8457 L159,2513.8457 L149,2523.8457 L92,2523.8457 L92,2506.8457 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2225.5" x="92" y="2506.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="107" y="2520.4141">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="174" y="2519.4805">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#fjsustprpwr89)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="2207.5" x="99" y="2549.1563"/><polygon fill="#EEEEEE" points="99,2549.1563,163,2549.1563,163,2556.1563,153,2566.1563,99,2566.1563,99,2549.1563" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="112" y="2563.7246">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="1083.75" y="2582.7246">Send notification to Participant (Payee)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1087.75" y="2598.0352"/><polygon fill="#A80036" points="137.5,2627.3984,127.5,2631.3984,137.5,2635.3984,133.5,2631.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131.5" x2="640.5" y1="2631.3984" y2="2631.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="143.5" y="2626.6563">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="165.5" y="2626.6563">Send callback notification</text><!--
@startuml
title 2.1.0. DFSP2 sends a Fulfil Success Transfer request

autonumber


actor "DFSP1\nPayer" as DFSP1
actor "DFSP2\nPayee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API \nNotification Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "topic-\nbulk-fulfil" as TOPIC_BULK_FULFIL
control "Bulk Fulfil\nHandler" as BULK_FULFIL_HANDLER
collections "topic-\nfulfil" as TOPIC_FULFIL
control "Fulfil \nHandler" as FULF_HANDLER
collections "topic-\ntransfer-position" as TOPIC_TRANSFER_POSITION
control "Position \nHandler" as POS_HANDLER
collections "topic-\nbulk-processing" as TOPIC_BULK_PROCESSING
control "Bulk Processing\nHandler" as BULK_PROC_HANDLER
collections "topic-\nnotification" as TOPIC_NOTIFICATIONS

box "Financial Service Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
    participant TOPIC_BULK_FULFIL
    participant BULK_FULFIL_HANDLER
	participant TOPIC_FULFIL
    participant FULF_HANDLER
    participant TOPIC_TRANSFER_POSITION
    participant POS_HANDLER
    participant TOPIC_BULK_PROCESSING
    participant BULK_PROC_HANDLER
    participant TOPIC_NOTIFICATIONS
end box

activate NOTIFY_HANDLER
activate BULK_FULFIL_HANDLER
activate FULF_HANDLER
activate POS_HANDLER
activate BULK_PROC_HANDLER
group DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1
    note right of DFSP2 #yellow
        Headers - transferHeaders: {
            Content-Length: <Content-Length>,
            Content-Type: <Content-Type>,
            Date: <Date>,
            X-Forwarded-For: <X-Forwarded-For>,
            FSPIOP-Source: <FSPIOP-Source>,
            FSPIOP-Destination: <FSPIOP-Destination>,
            FSPIOP-Encryption: <FSPIOP-Encryption>,
            FSPIOP-Signature: <FSPIOP-Signature>,
            FSPIOP-URI: <FSPIOP-URI>,
            FSPIOP-HTTP-Method: <FSPIOP-HTTP-Method>
        }

        Payload - bulkTransferMessage:
        {
            “completedTimestamp": <completedTimeStamp>,
            “bulkTransferState”: <bulkTransferState>,
            “individualTransferResults”: 
            [
                {
                    "transferId": <uuid>, 
                    “fulfilment”: <ilpCondition>,
                    "extensionList":
                    {
                        "extension":
                        [ 
                            { 
                                “key”: <key>, 
                                “value”: <value> 
                            }
                        ]
                    }
                }
            ],
            "extensionList": {
                "extension": [
                    {
                        “key”: <key>, 
                        “value”: <value> 
                    }
                ]
            }
        }
    end note
    DFSP2 ->> MLAPI: PUT - /bulkTransfers/<ID>
    activate MLAPI
    MLAPI -> MLAPI: Validate incoming message &\noriginator matching Payee\n<color #FF0000><b>Error codes:</b> 3000-3002, 3100-3107</color>
    note right of MLAPI #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    type: bulk-fulfil,
                    action: bulk-commit,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    MLAPI -> TOPIC_BULK_FULFIL: Route & Publish Bulk Fulfil event for Payee\n<color #FF0000><b>Error code:</b> 2003</color>
    activate TOPIC_BULK_FULFIL
    TOPIC_BULK_FULFIL <-> TOPIC_BULK_FULFIL: Ensure event is replicated \nas configured (ACKS=all)\n<color #FF0000><b>Error code:</b> 2003</color>
    TOPIC_BULK_FULFIL - -> MLAPI: Respond replication acknowledgements \nhave been received
    deactivate TOPIC_BULK_FULFIL
    MLAPI - ->> DFSP2: Respond HTTP - 200 (OK)
    deactivate MLAPI
    TOPIC_BULK_FULFIL <- BULK_FULFIL_HANDLER: Consume message
    ref over TOPIC_BULK_FULFIL, TOPIC_FULFIL: Bulk Fulfil Handler Consume\n
    alt Success
        BULK_FULFIL_HANDLER -> TOPIC_FULFIL: Produce message
    else Failure
        BULK_FULFIL_HANDLER - -> TOPIC_NOTIFICATIONS: Produce message
    end
    |||
    TOPIC_FULFIL <- FULF_HANDLER: Consume message
    ref over TOPIC_FULFIL, TOPIC_TRANSFER_POSITION: Fulfil Handler Consume (Success)\n
    alt Success
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Produce message
    else Failure
        FULF_HANDLER - -> TOPIC_BULK_PROCESSING: Produce message
    end
    |||
    TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume message
    ref over TOPIC_TRANSFER_POSITION, TOPIC_BULK_PROCESSING: Position Handler Consume (Success)\n
    POS_HANDLER -> TOPIC_BULK_PROCESSING: Produce message
    |||
    TOPIC_BULK_PROCESSING <- BULK_PROC_HANDLER: Consume message
    ref over TOPIC_BULK_PROCESSING, TOPIC_NOTIFICATIONS: Position Handler Consume (Success)\n
    BULK_PROC_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    opt action == 'commit'
        |||
        ref over DFSP1, TOPIC_NOTIFICATIONS: Send notification to Participant (Payer)\n
        NOTIFY_HANDLER -> DFSP1: Send callback notification
    end
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    opt action == 'commit'
        |||
        ref over DFSP2, TOPIC_NOTIFICATIONS: Send notification to Participant (Payee)\n
        NOTIFY_HANDLER -> DFSP2: Send callback notification
    end
    |||
end
deactivate POS_HANDLER
activate BULK_FULFIL_HANDLER
deactivate FULF_HANDLER
deactivate BULK_PROC_HANDLER
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2018.05(Sat May 05 23:00:17 EEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Mac OS X
OS Version: 10.14.4
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>