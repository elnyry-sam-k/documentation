<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2787px" preserveAspectRatio="none" style="width:2455px;height:2787px;" version="1.1" viewBox="0 0 2455 2787" width="2455px" zoomAndPan="magnify"><defs><filter height="300%" id="f1epmi6v2p55og" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="374" x="1041.75" y="23.5352">2.1.0. DFSP2 sends a Fulfil Success Transfer request</text><rect fill="#D3D3D3" height="2741.5762" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="7" y="47.0566">Financial Service Providers</text><rect fill="#ADD8E6" height="2741.5762" style="stroke: #A80036; stroke-width: 1.0;" width="524.5" x="314.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="498.25" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="2741.5762" style="stroke: #A80036; stroke-width: 1.0;" width="1587.5" x="841" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="1584.25" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="625.248" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="368.5" y="891.75"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2499.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="758.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1029.5" y="1370.1348"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2500.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1231.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2499.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1551.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2499.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1880.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2499.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2209.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2485.3125" style="stroke: #000000; stroke-width: 2.0;" width="2421.5" x="23" y="170.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="933" x="1190" y="1622.2402"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="933" x="1190" y="1668.8613"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="606.5" x="1516.5" y="1842.3691"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="606.5" x="1516.5" y="1888.9902"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2401.5" x="33" y="2290.6719"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2342.5" x="92" y="2491.5352"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="67" x2="67" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126" x2="126" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="373.5" x2="373.5" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="763" x2="763" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="912" x2="912" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1034" x2="1034" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1236" x2="1236" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1387.5" x2="1387.5" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1556.5" x2="1556.5" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1716.5" x2="1716.5" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1885" x2="1885" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2045" x2="2045" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2214" x2="2214" y1="153.7754" y2="2673.0879"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2374.5" x2="2374.5" y1="153.7754" y2="2673.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="134.334">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="150.8223">Payer</text><ellipse cx="67.5" cy="63.7988" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,71.7988 L67.5,98.7988 M54.5,79.7988 L80.5,79.7988 M67.5,98.7988 L54.5,113.7988 M67.5,98.7988 L80.5,113.7988 " fill="none" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="2685.623">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="2702.1113">Payer</text><ellipse cx="67.5" cy="2715.0645" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,2723.0645 L67.5,2750.0645 M54.5,2731.0645 L80.5,2731.0645 M67.5,2750.0645 L54.5,2765.0645 M67.5,2750.0645 L80.5,2765.0645 " fill="none" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="134.334">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="150.8223">Payee</text><ellipse cx="126.5" cy="63.7988" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,71.7988 L126.5,98.7988 M113.5,79.7988 L139.5,79.7988 M126.5,98.7988 L113.5,113.7988 M126.5,98.7988 L139.5,113.7988 " fill="none" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="2685.623">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="104" y="2702.1113">Payee</text><ellipse cx="126.5" cy="2715.0645" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,2723.0645 L126.5,2750.0645 M113.5,2731.0645 L139.5,2731.0645 M126.5,2750.0645 L113.5,2765.0645 M126.5,2750.0645 L139.5,2765.0645 " fill="none" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="318.5" y="150.8223">ML API Adapter</text><path d="M353,109.2871 L353,133.2871 M353,121.2871 L370,121.2871 " fill="none" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="382" cy="121.2871" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="318.5" y="2685.623">ML API Adapter</text><path d="M353,2692.5762 L353,2716.5762 M353,2704.5762 L370,2704.5762 " fill="none" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="382" cy="2704.5762" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="736" y="134.334">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="692" y="150.8223">Notification Handler</text><ellipse cx="763.5" cy="104.7988" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="759.5,92.7988,765.5,87.7988,763.5,92.7988,765.5,97.7988,759.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="736" y="2685.623">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="692" y="2702.1113">Notification Handler</text><ellipse cx="763.5" cy="2721.0645" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="759.5,2709.0645,765.5,2704.0645,763.5,2709.0645,765.5,2714.0645,759.5,2709.0645" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="845" y="150.8223">Central Service API</text><path d="M891.5,109.2871 L891.5,133.2871 M891.5,121.2871 L908.5,121.2871 " fill="none" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="920.5" cy="121.2871" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="845" y="2685.623">Central Service API</text><path d="M891.5,2692.5762 L891.5,2716.5762 M891.5,2704.5762 L908.5,2704.5762 " fill="none" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="920.5" cy="2704.5762" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="993" y="97.7988"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="989" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1009.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="996" y="138.8223">bulk-fulfil</text><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="993" y="2672.0879"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="989" y="2676.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1009.5" y="2696.623">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="996" y="2713.1113">bulk-fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1200" y="134.334">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1206.5" y="150.8223">Handler</text><ellipse cx="1236.5" cy="104.7988" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1232.5,92.7988,1238.5,87.7988,1236.5,92.7988,1238.5,97.7988,1232.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1200" y="2685.623">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1206.5" y="2702.1113">Handler</text><ellipse cx="1236.5" cy="2721.0645" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1232.5,2709.0645,1238.5,2704.0645,1236.5,2709.0645,1238.5,2714.0645,1232.5,2709.0645" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1359.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1355.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1362.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1368" y="138.8223">fulfil</text><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1359.5" y="2672.0879"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1355.5" y="2676.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1362.5" y="2696.623">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1368" y="2713.1113">fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1534.5" y="134.334">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1526.5" y="150.8223">Handler</text><ellipse cx="1556.5" cy="104.7988" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1552.5,92.7988,1558.5,87.7988,1556.5,92.7988,1558.5,97.7988,1552.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1534.5" y="2685.623">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1526.5" y="2702.1113">Handler</text><ellipse cx="1556.5" cy="2721.0645" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1552.5,2709.0645,1558.5,2704.0645,1556.5,2709.0645,1558.5,2714.0645,1552.5,2709.0645" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1650.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1646.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1691.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1653.5" y="138.8223">transfer-position</text><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1650.5" y="2672.0879"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="1646.5" y="2676.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1691.5" y="2696.623">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1653.5" y="2713.1113">transfer-position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="1853" y="134.334">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1855.5" y="150.8223">Handler</text><ellipse cx="1885.5" cy="104.7988" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1881.5,92.7988,1887.5,87.7988,1885.5,92.7988,1887.5,97.7988,1881.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="1853" y="2685.623">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="1855.5" y="2702.1113">Handler</text><ellipse cx="1885.5" cy="2721.0645" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1881.5,2709.0645,1887.5,2704.0645,1885.5,2709.0645,1887.5,2714.0645,1881.5,2709.0645" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1982" y="97.7988"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1978" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2020.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1985" y="138.8223">bulk-processing</text><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1982" y="2672.0879"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1978" y="2676.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2020.5" y="2696.623">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1985" y="2713.1113">bulk-processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="2158" y="134.334">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2184.5" y="150.8223">Handler</text><ellipse cx="2214.5" cy="104.7988" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2210.5,92.7988,2216.5,87.7988,2214.5,92.7988,2216.5,97.7988,2210.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="2158" y="2685.623">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="2184.5" y="2702.1113">Handler</text><ellipse cx="2214.5" cy="2721.0645" fill="#FEFECE" filter="url(#f1epmi6v2p55og)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2210.5,2709.0645,2216.5,2704.0645,2214.5,2709.0645,2216.5,2714.0645,2210.5,2709.0645" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2328.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2324.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2349.5" y="122.334">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2331.5" y="138.8223">notification</text><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2328.5" y="2672.0879"/><rect fill="#FEFECE" filter="url(#f1epmi6v2p55og)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="2324.5" y="2676.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="2349.5" y="2696.623">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2331.5" y="2713.1113">notification</text><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="625.248" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="368.5" y="891.75"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2499.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="758.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="117.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1029.5" y="1370.1348"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2500.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1231.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2499.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1551.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2499.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1880.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="2499.3125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2209.5" y="163.7754"/><path d="M23,170.7754 L471,170.7754 L471,177.7754 L461,187.7754 L23,187.7754 L23,170.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="2485.3125" style="stroke: #000000; stroke-width: 2.0;" width="2421.5" x="23" y="170.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="403" x="38" y="184.3438">DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1</text><path d="M131,193.0859 L131,861.0859 L482,861.0859 L482,203.0859 L472,193.0859 L131,193.0859 " fill="#FFFF00" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M472,193.0859 L472,203.0859 L482,203.0859 L472,193.0859 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="137" y="210.6543">Headers - transferHeaders: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="153" y="225.9648">Content-Length: &lt;Content-Length&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="153" y="241.2754">Content-Type: &lt;Content-Type&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="153" y="256.5859">Date: &lt;Date&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="153" y="271.8965">X-Forwarded-For: &lt;X-Forwarded-For&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="153" y="287.207">FSPIOP-Source: &lt;FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="153" y="302.5176">FSPIOP-Destination: &lt;FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="153" y="317.8281">FSPIOP-Encryption: &lt;FSPIOP-Encryption&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="153" y="333.1387">FSPIOP-Signature: &lt;FSPIOP-Signature&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="153" y="348.4492">FSPIOP-URI: &lt;FSPIOP-URI&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="153" y="363.7598">FSPIOP-HTTP-Method: &lt;FSPIOP-HTTP-Method&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="379.0703">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="141" y="394.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="137" y="409.6914">Payload - bulkTransferMessage:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="425.002">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="153" y="440.3125">“completedTimestamp": &lt;completedTimeStamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="264" x="153" y="455.623">“bulkTransferState”: &lt;bulkTransferState&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="153" y="470.9336">“individualTransferResults”:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="153" y="486.2441">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="501.5547">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="185" y="516.8652">"transferId": &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="185" y="532.1758">“fulfilment”: &lt;ilpCondition&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="185" y="547.4863">"extensionList":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="562.7969">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="201" y="578.1074">"extension":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="201" y="593.418">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="217" y="608.7285">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="233" y="624.0391">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="233" y="639.3496">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="217" y="654.6602">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="201" y="669.9707">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="685.2813">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="700.5918">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="153" y="715.9023">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="153" y="731.2129">"extensionList": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="169" y="746.5234">"extension": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="761.834">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="201" y="777.1445">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="201" y="792.4551">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="185" y="807.7656">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="169" y="823.0762">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="153" y="838.3867">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="137" y="853.6973">}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="366.5" x2="356.5" y1="891.75" y2="887.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="366.5" x2="356.5" y1="891.75" y2="895.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="367.5" y1="891.75" y2="891.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="133.5" y="887.0078">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="146.5" y="887.0078">PUT - /bulkTransfers/&lt;ID&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="420.5" y1="936.3711" y2="936.3711"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="420.5" x2="420.5" y1="936.3711" y2="949.3711"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="420.5" y1="949.3711" y2="949.3711"/><polygon fill="#A80036" points="389.5,945.3711,379.5,949.3711,389.5,953.3711,385.5,949.3711" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="923.9736">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="353" x="398.5" y="916.3184">Validate incoming message &amp; originator matching Payee</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="398.5" y="931.6289">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="482.5" y="931.6289">3000-3002, 3100-3107</text><path d="M383,962.3711 L383,1324.3711 L692,1324.3711 L692,972.3711 L682,962.3711 L383,962.3711 " fill="#FFFF00" filter="url(#f1epmi6v2p55og)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M682,962.3711 L682,972.3711 L692,972.3711 L682,962.3711 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="389" y="979.9395">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="389" y="995.25">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="405" y="1010.5605">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="405" y="1025.8711">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="405" y="1041.1816">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="405" y="1056.4922">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="405" y="1071.8027">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="421" y="1087.1133">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="421" y="1102.4238">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="405" y="1117.7344">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="405" y="1133.0449">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="421" y="1148.3555">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="437" y="1163.666">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="437" y="1178.9766">type: bulk-fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="437" y="1194.2871">action: bulk-commit,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="437" y="1209.5977">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="437" y="1224.9082">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="453" y="1240.2188">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="453" y="1255.5293">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="437" y="1270.8398">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="421" y="1286.1504">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="405" y="1301.4609">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="389" y="1316.7715">}</text><polygon fill="#A80036" points="1017.5,1366.1348,1027.5,1370.1348,1017.5,1374.1348,1021.5,1370.1348" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="378.5" x2="1023.5" y1="1370.1348" y2="1370.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.5" y="1357.7373">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="398.5" y="1350.082">Route &amp; Publish Bulk Fulfil event for Payee</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="398.5" y="1365.3926">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="475.5" y="1365.3926">2003</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1039.5" x2="1081.5" y1="1430.0664" y2="1430.0664"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1081.5" x2="1081.5" y1="1430.0664" y2="1443.0664"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1040.5" x2="1081.5" y1="1443.0664" y2="1443.0664"/><polygon fill="#A80036" points="1050.5,1439.0664,1040.5,1443.0664,1050.5,1447.0664,1046.5,1443.0664" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1046.5" y="1410.0137">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="1059.5" y="1394.7031">Ensure event is replicated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="1059.5" y="1410.0137">as configured (ACKS=all)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="1059.5" y="1425.3242">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1136.5" y="1425.3242">2003</text><polygon fill="#A80036" points="389.5,1483.6875,379.5,1487.6875,389.5,1491.6875,385.5,1487.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="383.5" x2="1033.5" y1="1487.6875" y2="1487.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="395.5" y="1475.29">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="408.5" y="1467.6348">Respond replication acknowledgements</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="408.5" y="1482.9453">have been received</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="136.5" y1="1516.998" y2="1512.998"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126.5" x2="136.5" y1="1516.998" y2="1520.998"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="126.5" x2="372.5" y1="1516.998" y2="1516.998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="143.5" y="1512.2559">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="156.5" y="1512.2559">Respond HTTP - 200 (OK)</text><polygon fill="#A80036" points="1045.5,1542.3086,1035.5,1546.3086,1045.5,1550.3086,1041.5,1546.3086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1039.5" x2="1230.5" y1="1546.3086" y2="1546.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1051.5" y="1541.5664">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1064.5" y="1541.5664">Consume message</text><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="432.5" x="986" y="1554.3086"/><polygon fill="#EEEEEE" points="986,1554.3086,1050,1554.3086,1050,1561.3086,1040,1571.3086,986,1571.3086,986,1554.3086" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="999" y="1568.877">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="1090.75" y="1587.877">Bulk Fulfil Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/documentation/tree/master/mojaloop-technical-overview/central-bulk-transfers/assets/diagrams/sequence/seq-bulk-fulfil-1.1.4.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/documentation/tree/master/mojaloop-technical-overview/central-bulk-transfers/assets/diagrams/sequence/seq-bulk-fulfil-1.1.4.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="32" x="1277.75" y="1587.877">1.1.4</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1277.75" x2="1309.75" y1="1589.877" y2="1589.877"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1309.75" y="1587.877">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1094.75" y="1603.1875"/><path d="M1190,1622.2402 L1252,1622.2402 L1252,1629.2402 L1242,1639.2402 L1190,1639.2402 L1190,1622.2402 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="933" x="1190" y="1622.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1205" y="1635.8086">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1267" y="1634.875">[Success]</text><polygon fill="#A80036" points="1375.5,1656.8613,1385.5,1660.8613,1375.5,1664.8613,1379.5,1660.8613" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1241.5" x2="1381.5" y1="1660.8613" y2="1660.8613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1248.5" y="1656.1191">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1261.5" y="1656.1191">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1190" x2="2123" y1="1669.8613" y2="1669.8613"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1195" y="1680.4961">[Failure]</text><polygon fill="#A80036" points="2033.5,1701.127,2043.5,1705.127,2033.5,1709.127,2037.5,1705.127" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1241.5" x2="2039.5" y1="1705.127" y2="1705.127"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1248.5" y="1700.3848">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="1261.5" y="1700.3848">Produce Notification</text><polygon fill="#A80036" points="1398.5,1762.4375,1388.5,1766.4375,1398.5,1770.4375,1394.5,1766.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1392.5" x2="1550.5" y1="1766.4375" y2="1766.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1404.5" y="1761.6953">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1426.5" y="1761.6953">Consume message</text><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="433" x="1352.5" y="1774.4375"/><polygon fill="#EEEEEE" points="1352.5,1774.4375,1416.5,1774.4375,1416.5,1781.4375,1406.5,1791.4375,1352.5,1791.4375,1352.5,1774.4375" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1365.5" y="1789.0059">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="1442" y="1808.0059">Fulfil Handler Consume (Success) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/documentation/tree/master/mojaloop-technical-overview/central-ledger/assets/diagrams/sequence/seq-fulfil-2.1.1.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/documentation/tree/master/mojaloop-technical-overview/central-ledger/assets/diagrams/sequence/seq-fulfil-2.1.1.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="32" x="1660" y="1808.0059">2.1.1</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1660" x2="1692" y1="1810.0059" y2="1810.0059"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1692" y="1808.0059">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1446" y="1823.3164"/><path d="M1516.5,1842.3691 L1578.5,1842.3691 L1578.5,1849.3691 L1568.5,1859.3691 L1516.5,1859.3691 L1516.5,1842.3691 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.8867" style="stroke: #000000; stroke-width: 2.0;" width="606.5" x="1516.5" y="1842.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1531.5" y="1855.9375">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1593.5" y="1855.0039">[Success]</text><polygon fill="#A80036" points="1704.5,1876.9902,1714.5,1880.9902,1704.5,1884.9902,1708.5,1880.9902" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1561.5" x2="1710.5" y1="1880.9902" y2="1880.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1568.5" y="1876.248">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1590.5" y="1876.248">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1516.5" x2="2123" y1="1889.9902" y2="1889.9902"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1521.5" y="1900.625">[Failure]</text><polygon fill="#A80036" points="2033.5,1921.2559,2043.5,1925.2559,2033.5,1929.2559,2037.5,1925.2559" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1561.5" x2="2039.5" y1="1925.2559" y2="1925.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1568.5" y="1920.5137">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1590.5" y="1920.5137">Produce message</text><polygon fill="#A80036" points="1727.5,1982.5664,1717.5,1986.5664,1727.5,1990.5664,1723.5,1986.5664" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1721.5" x2="1879.5" y1="1986.5664" y2="1986.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1733.5" y="1981.8242">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1755.5" y="1981.8242">Consume message</text><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="468.5" x="1643.5" y="1994.5664"/><polygon fill="#EEEEEE" points="1643.5,1994.5664,1707.5,1994.5664,1707.5,2001.5664,1697.5,2011.5664,1643.5,2011.5664,1643.5,1994.5664" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1656.5" y="2009.1348">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="1741.25" y="2028.1348">Position Handler Consume (Success) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.2-fulfil.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.2-fulfil.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="32" x="1978.25" y="2028.1348">1.3.2</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1978.25" x2="2010.25" y1="2030.1348" y2="2030.1348"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2010.25" y="2028.1348">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1745.25" y="2043.4453"/><polygon fill="#A80036" points="2033.5,2072.8086,2043.5,2076.8086,2033.5,2080.8086,2037.5,2076.8086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1890.5" x2="2039.5" y1="2076.8086" y2="2076.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1897.5" y="2072.0664">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1919.5" y="2072.0664">Produce message</text><polygon fill="#A80036" points="2056.5,2127.1191,2046.5,2131.1191,2056.5,2135.1191,2052.5,2131.1191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2050.5" x2="2208.5" y1="2131.1191" y2="2131.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2062.5" y="2126.377">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="2084.5" y="2126.377">Consume message</text><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="448.5" x="1975" y="2139.1191"/><polygon fill="#EEEEEE" points="1975,2139.1191,2039,2139.1191,2039,2146.1191,2029,2156.1191,1975,2156.1191,1975,2139.1191" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1988" y="2153.6875">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="2062.75" y="2172.6875">Position Handler Consume (Success) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.2-fulfil.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.2-fulfil.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="32" x="2299.75" y="2172.6875">1.3.2</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="2299.75" x2="2331.75" y1="2174.6875" y2="2174.6875"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2331.75" y="2172.6875">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="2066.75" y="2187.998"/><polygon fill="#A80036" points="2362.5,2217.3613,2372.5,2221.3613,2362.5,2225.3613,2366.5,2221.3613" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2219.5" x2="2368.5" y1="2221.3613" y2="2221.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2226.5" y="2216.6191">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="2248.5" y="2216.6191">Produce message</text><polygon fill="#A80036" points="2362.5,2271.6719,2372.5,2275.6719,2362.5,2279.6719,2366.5,2275.6719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="2368.5" y1="2275.6719" y2="2275.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="775.5" y="2270.9297">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="797.5" y="2270.9297">Consume message</text><path d="M33,2290.6719 L100,2290.6719 L100,2297.6719 L90,2307.6719 L33,2307.6719 L33,2290.6719 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2401.5" x="33" y="2290.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="48" y="2304.2402">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="115" y="2303.3066">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="2383.5" x="40" y="2332.9824"/><polygon fill="#EEEEEE" points="40,2332.9824,104,2332.9824,104,2339.9824,94,2349.9824,40,2349.9824,40,2332.9824" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="53" y="2347.5508">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="1084.25" y="2366.5508">Send notification to Participant (Payer) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="43" x="1332.25" y="2366.5508">1.1.4.a</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1332.25" x2="1375.25" y1="2368.5508" y2="2368.5508"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1375.25" y="2366.5508">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1088.25" y="2381.8613"/><polygon fill="#A80036" points="78.5,2411.2246,68.5,2415.2246,78.5,2419.2246,74.5,2415.2246" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="757.5" y1="2415.2246" y2="2415.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="2410.4824">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="106.5" y="2410.4824">Send callback notification</text><polygon fill="#A80036" points="2362.5,2472.5352,2372.5,2476.5352,2362.5,2480.5352,2366.5,2476.5352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="2368.5" y1="2476.5352" y2="2476.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="775.5" y="2471.793">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="797.5" y="2471.793">Consume message</text><path d="M92,2491.5352 L159,2491.5352 L159,2498.5352 L149,2508.5352 L92,2508.5352 L92,2491.5352 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.5527" style="stroke: #000000; stroke-width: 2.0;" width="2342.5" x="92" y="2491.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="107" y="2505.1035">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="174" y="2504.1699">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#f1epmi6v2p55og)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="2324.5" x="99" y="2533.8457"/><polygon fill="#EEEEEE" points="99,2533.8457,163,2533.8457,163,2540.8457,153,2550.8457,99,2550.8457,99,2533.8457" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="112" y="2548.4141">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="1112.75" y="2567.4141">Send notification to Participant (Payee) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="43" x="1362.75" y="2567.4141">1.1.4.a</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1362.75" x2="1405.75" y1="2569.4141" y2="2569.4141"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1405.75" y="2567.4141">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1116.75" y="2582.7246"/><polygon fill="#A80036" points="137.5,2612.0879,127.5,2616.0879,137.5,2620.0879,133.5,2616.0879" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131.5" x2="757.5" y1="2616.0879" y2="2616.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="143.5" y="2611.3457">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="165.5" y="2611.3457">Send callback notification</text><!--
@startuml
title 2.1.0. DFSP2 sends a Fulfil Success Transfer request

autonumber


actor "DFSP1\nPayer" as DFSP1
actor "DFSP2\nPayee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API \nNotification Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "topic-\nbulk-fulfil" as TOPIC_BULK_FULFIL
control "Bulk Fulfil\nHandler" as BULK_FULFIL_HANDLER
collections "topic-\nfulfil" as TOPIC_FULFIL
control "Fulfil \nHandler" as FULF_HANDLER
collections "topic-\ntransfer-position" as TOPIC_TRANSFER_POSITION
control "Position \nHandler" as POS_HANDLER
collections "topic-\nbulk-processing" as TOPIC_BULK_PROCESSING
control "Bulk Processing\nHandler" as BULK_PROC_HANDLER
collections "topic-\nnotification" as TOPIC_NOTIFICATIONS

box "Financial Service Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
    participant TOPIC_BULK_FULFIL
    participant BULK_FULFIL_HANDLER
	participant TOPIC_FULFIL
    participant FULF_HANDLER
    participant TOPIC_TRANSFER_POSITION
    participant POS_HANDLER
    participant TOPIC_BULK_PROCESSING
    participant BULK_PROC_HANDLER
    participant TOPIC_NOTIFICATIONS
end box

activate NOTIFY_HANDLER
activate BULK_FULFIL_HANDLER
activate FULF_HANDLER
activate POS_HANDLER
activate BULK_PROC_HANDLER
group DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1
    note right of DFSP2 #yellow
        Headers - transferHeaders: {
            Content-Length: <Content-Length>,
            Content-Type: <Content-Type>,
            Date: <Date>,
            X-Forwarded-For: <X-Forwarded-For>,
            FSPIOP-Source: <FSPIOP-Source>,
            FSPIOP-Destination: <FSPIOP-Destination>,
            FSPIOP-Encryption: <FSPIOP-Encryption>,
            FSPIOP-Signature: <FSPIOP-Signature>,
            FSPIOP-URI: <FSPIOP-URI>,
            FSPIOP-HTTP-Method: <FSPIOP-HTTP-Method>
        }

        Payload - bulkTransferMessage:
        {
            “completedTimestamp": <completedTimeStamp>,
            “bulkTransferState”: <bulkTransferState>,
            “individualTransferResults”: 
            [
                {
                    "transferId": <uuid>, 
                    “fulfilment”: <ilpCondition>,
                    "extensionList":
                    {
                        "extension":
                        [ 
                            { 
                                “key”: <key>, 
                                “value”: <value> 
                            }
                        ]
                    }
                }
            ],
            "extensionList": {
                "extension": [
                    {
                        “key”: <key>, 
                        “value”: <value> 
                    }
                ]
            }
        }
    end note
    DFSP2 ->> MLAPI: PUT - /bulkTransfers/<ID>
    activate MLAPI
    MLAPI -> MLAPI: Validate incoming message & originator matching Payee\n<color #FF0000><b>Error codes:</b> 3000-3002, 3100-3107</color>
    note right of MLAPI #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    type: bulk-fulfil,
                    action: bulk-commit,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    MLAPI -> TOPIC_BULK_FULFIL: Route & Publish Bulk Fulfil event for Payee\n<color #FF0000><b>Error code:</b> 2003</color>
    activate TOPIC_BULK_FULFIL
    TOPIC_BULK_FULFIL <-> TOPIC_BULK_FULFIL: Ensure event is replicated \nas configured (ACKS=all)\n<color #FF0000><b>Error code:</b> 2003</color>
    TOPIC_BULK_FULFIL - -> MLAPI: Respond replication acknowledgements \nhave been received
    deactivate TOPIC_BULK_FULFIL
    MLAPI - ->> DFSP2: Respond HTTP - 200 (OK)
    deactivate MLAPI
    TOPIC_BULK_FULFIL <- BULK_FULFIL_HANDLER: Consume message
    ref over TOPIC_BULK_FULFIL, TOPIC_FULFIL: Bulk Fulfil Handler Consume {[[https://github.com/mojaloop/documentation/tree/master/mojaloop-technical-overview/central-bulk-transfers/assets/diagrams/sequence/seq-bulk-fulfil-1.1.4.svg 1.1.4]]} \n
    alt Success
        BULK_FULFIL_HANDLER -> TOPIC_FULFIL: Produce message
    else Failure
        BULK_FULFIL_HANDLER -> TOPIC_BULK_PROCESSING: Produce Notification
    end
    |||
    TOPIC_FULFIL <- FULF_HANDLER: Consume message
    ref over TOPIC_FULFIL, TOPIC_TRANSFER_POSITION: Fulfil Handler Consume (Success) {[[https://github.com/mojaloop/documentation/tree/master/mojaloop-technical-overview/central-ledger/assets/diagrams/sequence/seq-fulfil-2.1.1.svg 2.1.1]]} \n
    alt Success
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Produce message
    else Failure
        FULF_HANDLER -> TOPIC_BULK_PROCESSING: Produce message
    end
    |||
    TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume message
    ref over TOPIC_TRANSFER_POSITION, TOPIC_BULK_PROCESSING:  Position Handler Consume (Success) {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.2-fulfil.svg 1.3.2]]} \n
    POS_HANDLER -> TOPIC_BULK_PROCESSING: Produce message
    |||
    TOPIC_BULK_PROCESSING <- BULK_PROC_HANDLER: Consume message
    ref over TOPIC_BULK_PROCESSING, TOPIC_NOTIFICATIONS:  Position Handler Consume (Success) {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.2-fulfil.svg 1.3.2]]} \n
    BULK_PROC_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    opt action == 'commit'
        |||
        ref over DFSP1, TOPIC_NOTIFICATIONS: Send notification to Participant (Payer) {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg 1.1.4.a]]} \n
        NOTIFY_HANDLER -> DFSP1: Send callback notification
    end
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    opt action == 'commit'
        |||
        ref over DFSP2, TOPIC_NOTIFICATIONS: Send notification to Participant (Payee) {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg 1.1.4.a]]} \n
        NOTIFY_HANDLER -> DFSP2: Send callback notification
    end
    |||
end
deactivate POS_HANDLER
activate BULK_FULFIL_HANDLER
deactivate FULF_HANDLER
deactivate BULK_PROC_HANDLER
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2018.05(Sat May 05 23:00:17 EEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Mac OS X
OS Version: 10.14.4
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>